!function(){var e,t={34281:function(e,t,n){"use strict";n(77474);function o(e){return o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o(e)}function i(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,(r=i.key,a=void 0,a=function(e,t){if("object"!==o(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var i=n.call(e,t||"default");if("object"!==o(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(r,"string"),"symbol"===o(a)?a:String(a)),i)}var r,a}var r=function(){return e=function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.listSelector=t.listSelector,this.minItems=t.minItems,this.hideOnMinItemsOrLessSelector=t.hideOnMinItemsOrLessSelector,this.run()},(t=[{key:"run",value:function(){var e=$(this.listSelector),t=e.find(this.hideOnMinItemsOrLessSelector);e.length<=this.minItems?t.hide():t.show()}}])&&i(e.prototype,t),n&&i(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,t,n}();function a(e){return a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},a(e)}function l(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,(i=o.key,r=void 0,r=function(e,t){if("object"!==a(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var o=n.call(e,t||"default");if("object"!==a(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(i,"string"),"symbol"===a(r)?r:String(r)),o)}var i,r}var c=function(){return e=function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.wrapperSelector=t.wrapperSelector,this.selectSelector=t.selectSelector,this.listSelector=t.listSelector},(t=[{key:"run",value:function(){var e=$(this.listSelector),t=e.parents(this.wrapperSelector).find(this.selectSelector);t.find("option").slice(1).remove();for(var n=2;n<=e.length;n+=1)$('<option value="'.concat(n,'">').concat(n,"</option>")).appendTo(t)}}])&&l(e.prototype,t),n&&l(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,t,n}();function u(e){return u="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},u(e)}function d(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,(i=o.key,r=void 0,r=function(e,t){if("object"!==u(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var o=n.call(e,t||"default");if("object"!==u(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(i,"string"),"symbol"===u(r)?r:String(r)),o)}var i,r}var s=function(){return e=function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.$source=t.source,this.$select=t.select,this.sourceToParams=t.sourceToParams,this.run()},(t=[{key:"run",value:function(){this.$source.on("change",this._onSourceChange.bind(this)),this._onSourceChange()}},{key:"_onSourceChange",value:function(){var e=this.$select,t=this.sourceToParams(this.$source),n=this.$source.data("url");$.getJSON(n,t,(function(t){e.find("option:not([value=''])").remove();var n=e.data("selected");t.forEach((function(t){var o=$('<option value="'.concat(t.id,'">').concat(t.body,"</option>")).appendTo(e);t.id===n&&o.attr("selected",!0)})),n&&e.val(n)}))}}])&&d(e.prototype,t),n&&d(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,t,n}();function f(e){return f="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},f(e)}function p(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,(i=o.key,r=void 0,r=function(e,t){if("object"!==f(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var o=n.call(e,t||"default");if("object"!==f(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(i,"string"),"symbol"===f(r)?r:String(r)),o)}var i,r}var m=function(){return e=function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.inputSelector=t.inputSelector,this.targetSelector=t.targetSelector,this.maxLength=t.maxLength,this.omission=t.omission,this.placeholder=t.placeholder,this._bindEvent(),this._run()},(t=[{key:"_run",value:function(){var e=$(this.inputSelector),t=$(this.targetSelector),n=e.val()||this.placeholder;n.length>this.maxLength&&(n=n.substring(0,this.maxLength-this.omission.length)+this.omission),t.text(n)}},{key:"_bindEvent",value:function(){$(this.inputSelector).on("change",this._run.bind(this))}}])&&p(e.prototype,t),n&&p(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,t,n}();function v(e){return v="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},v(e)}function h(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,(i=o.key,r=void 0,r=function(e,t){if("object"!==v(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var o=n.call(e,t||"default");if("object"!==v(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(i,"string"),"symbol"===v(r)?r:String(r)),o)}var i,r}var b=function(){return e=function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.listSelector=t.listSelector,this.hideOnFirstSelector=t.hideOnFirstSelector,this.hideOnLastSelector=t.hideOnLastSelector,this.run()},(t=[{key:"run",value:function(){var e=$(this.listSelector),t=this.hideOnFirstSelector,n=this.hideOnLastSelector;if(1===e.length){var o=e.first();o.find(t).hide(),o.find(n).hide()}else e.each((function(o,i){i.id===e.first().attr("id")?($(i).find(t).hide(),$(i).find(n).show()):i.id===e.last().attr("id")?($(i).find(n).hide(),$(i).find(t).show()):($(i).find(n).show(),$(i).find(t).show())}))}}])&&h(e.prototype,t),n&&h(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,t,n}();function y(e){return y="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},y(e)}function S(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,(i=o.key,r=void 0,r=function(e,t){if("object"!==y(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var o=n.call(e,t||"default");if("object"!==y(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(i,"string"),"symbol"===y(r)?r:String(r)),o)}var i,r}var g=function(){return e=function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.listSelector=t.listSelector,this.labelSelector=t.labelSelector,this.onPositionComputed=t.onPositionComputed,this.run()},(t=[{key:"run",value:function(){var e=this;$(this.listSelector).each((function(t,n){var o=$(n).find(e.labelSelector),i=o.html();i.match(/#(\d+)/)?o.html(i.replace(/#(\d+)/,"#".concat(t+1))):o.html("".concat(i," #").concat(t+1)),e.onPositionComputed&&e.onPositionComputed(n,t)}))}}])&&S(e.prototype,t),n&&S(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,t,n}(),w=n(64112);function F(e){return F="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},F(e)}function q(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,(i=o.key,r=void 0,r=function(e,t){if("object"!==F(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var o=n.call(e,t||"default");if("object"!==F(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(i,"string"),"symbol"===F(r)?r:String(r)),o)}var i,r}function _(e,t,n){return t&&q(e.prototype,t),n&&q(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}var k=_((function e(t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),$(t).length>0&&(0,w.Z)(t,n)[0].addEventListener("sortupdate",(function(e){var t=$(e.target).children();n.onSortUpdate&&n.onSortUpdate(t)}))}));function T(e){return T="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},T(e)}function E(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,(i=o.key,r=void 0,r=function(e,t){if("object"!==T(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var o=n.call(e,t||"default");if("object"!==T(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(i,"string"),"symbol"===T(r)?r:String(r)),o)}var i,r}var C=function(){return e=function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.wrapperSelector=t.wrapperSelector,this.containerSelector=t.containerSelector,this.fieldSelector=t.fieldSelector,this.addFieldButtonSelector=t.addFieldButtonSelector,this.addSeparatorButtonSelector=t.addSeparatorButtonSelector,this.addTitleAndDescriptionButtonSelector=t.addTitleAndDescriptionButtonSelector,this.fieldTemplateSelector=t.fieldTemplateSelector,this.separatorTemplateSelector=t.separatorTemplateSelector,this.TitleAndDescriptionTemplateSelector=t.TitleAndDescriptionTemplateSelector,this.removeFieldButtonSelector=t.removeFieldButtonSelector,this.moveUpFieldButtonSelector=t.moveUpFieldButtonSelector,this.moveDownFieldButtonSelector=t.moveDownFieldButtonSelector,this.onAddField=t.onAddField,this.onRemoveField=t.onRemoveField,this.onMoveUpField=t.onMoveUpField,this.onMoveDownField=t.onMoveDownField,this.placeholderId=t.placeholderId,this.elementCounter=0,this._enableInterpolation(),this._activateFields(),this._bindEvents()},t=[{key:"_enableInterpolation",value:function(){$.fn.replaceAttribute=function(e,t,n){return $(this).find("[".concat(e,"*=").concat(t,"]")).addBack("[".concat(e,"*=").concat(t,"]")).each((function(o,i){$(i).attr(e,$(i).attr(e).replace(t,n))})),this},$.fn.template=function(e,t){var n=$(this).find("template, .decidim-template");n.length>0&&n.html((function(n,o){return $(o).template(e,t)[0].outerHTML}));var o=$(this).find("[data-template]");return o.length>0&&o.each((function(n,o){var i=$(o),r=$(i.data("template")),a=$(r[0].outerHTML),l="".concat(r.attr("id"),"-").concat(t),c="#".concat(l);a.attr("id",l),i.attr("data-template",c).data("template",c),r.after(a),a.html((function(n,o){return $(o).template(e,t)[0].outerHTML}))})),$(this).replaceAttribute("id",e,t),$(this).replaceAttribute("name",e,t),$(this).replaceAttribute("data-tabs-content",e,t),$(this).replaceAttribute("for",e,t),$(this).replaceAttribute("tabs_id",e,t),$(this).replaceAttribute("href",e,t),$(this).replaceAttribute("value",e,t),this}}},{key:"_bindEvents",value:function(){var e=this;$(this.wrapperSelector).on("click",this.addFieldButtonSelector,(function(t){return e._bindSafeEvent(t,(function(){return e._addField(e.fieldTemplateSelector)}))})),this.addSeparatorButtonSelector&&$(this.wrapperSelector).on("click",this.addSeparatorButtonSelector,(function(t){return e._bindSafeEvent(t,(function(){return e._addField(e.separatorTemplateSelector)}))})),this.addTitleAndDescriptionButtonSelector&&$(this.wrapperSelector).on("click",this.addTitleAndDescriptionButtonSelector,(function(t){return e._bindSafeEvent(t,(function(){return e._addField(e.TitleAndDescriptionTemplateSelector)}))})),$(this.wrapperSelector).on("click",this.removeFieldButtonSelector,(function(t){return e._bindSafeEvent(t,(function(t){return e._removeField(t)}))})),this.moveUpFieldButtonSelector&&$(this.wrapperSelector).on("click",this.moveUpFieldButtonSelector,(function(t){return e._bindSafeEvent(t,(function(t){return e._moveUpField(t)}))})),this.moveDownFieldButtonSelector&&$(this.wrapperSelector).on("click",this.moveDownFieldButtonSelector,(function(t){return e._bindSafeEvent(t,(function(t){return e._moveDownField(t)}))}))}},{key:"_bindSafeEvent",value:function(e,t){e.preventDefault(),e.stopPropagation();try{return t(e.target)}catch(n){return console.error(n),n}}},{key:"_addField",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:".decidim-template",t=$(this.wrapperSelector),n=t.find(this.containerSelector),o=t.data("template"),i=null;o&&(i=$(o)),(null===i||i.length<1)&&(i=t.children("template, ".concat(e)));var r=$(i.html()).template(this.placeholderId,this._getUID());r.find("ul.tabs").attr("data-tabs",!0);var a=n.find(this.fieldSelector).last();a.length>0?a.after(r):r.appendTo(n),r.foundation(),this.onAddField&&this.onAddField(r)}},{key:"_removeField",value:function(e){var t=$(e).parents(this.fieldSelector);if(t.find("input").filter((function(e,t){return t.name.match(/id/)})).length>0){var n=t.find("input").filter((function(e,t){return t.name.match(/delete/)}));n.length>0&&$(n[0]).val(!0),t.addClass("hidden"),t.hide()}else t.remove();this.onRemoveField&&this.onRemoveField(t)}},{key:"_moveUpField",value:function(e){var t=$(e).parents(this.fieldSelector);t.prev().before(t),this.onMoveUpField&&this.onMoveUpField(t)}},{key:"_moveDownField",value:function(e){var t=$(e).parents(this.fieldSelector);t.next().after(t),this.onMoveDownField&&this.onMoveDownField(t)}},{key:"_activateFields",value:function(){var e=this,t=$(this.wrapperSelector).find(this.containerSelector);t.append(t.find("script")),$(this.fieldSelector).each((function(t,n){$(n).template(e.placeholderId,e._getUID()),$(n).find("ul.tabs").attr("data-tabs",!0)}))}},{key:"_getUID",value:function(){return this.elementCounter+=1,(new Date).getTime()+this.elementCounter}}],t&&E(e.prototype,t),n&&E(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,t,n}();function O(e){return new C(e)}function x(e){return x="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},x(e)}function P(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,(i=o.key,r=void 0,r=function(e,t){if("object"!==x(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var o=n.call(e,t||"default");if("object"!==x(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(i,"string"),"symbol"===x(r)?r:String(r)),o)}var i,r}var j=function(){return e=function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.controllerField=t.controllerField,this.wrapperSelector=t.wrapperSelector,this.dependentFieldsSelector=t.dependentFieldsSelector,this.dependentInputSelector=t.dependentInputSelector,this.enablingCondition=t.enablingCondition,this._bindEvent(),this._run()},(t=[{key:"_run",value:function(){var e=this.controllerField,t=e.parents(this.wrapperSelector).find(this.dependentFieldsSelector),n=t.find(this.dependentInputSelector);this.enablingCondition(e)?(n.prop("disabled",!1),t.show()):(n.prop("disabled",!0),t.hide())}},{key:"_bindEvent",value:function(){var e=this;this.controllerField.on("change",(function(){e._run()}))}}])&&P(e.prototype,t),n&&P(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,t,n}();function A(e){return new j(e)}var B=n(21351);n(35021),n(99712),n(83730);function D(e){return function(e){if(Array.isArray(e))return I(e)}(e)||function(e){if("undefined"!==typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"===typeof e)return I(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return I(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function I(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,o=new Array(t);n<t;n++)o[n]=e[n];return o}var L=["bold","italic","link","underline","header","list","video","image","alt","break","width","style","code","blockquote","indent"];function M(e){var t=$(e).data("toolbar"),n=$(e).data("disabled"),o=[["bold","italic","underline","linebreak"],[{list:"ordered"},{list:"bullet"}],["link","clean"],["code","blockquote"],[{indent:"-1"},{indent:"+1"}],[{savedDataset:"openModal"}]],i=$(e).data("editorImages");"full"===t?o=[[{header:[2,3,4,5,6,!1]}]].concat(D(o),[["video"]]):"basic"===t&&(o=[].concat(D(o),[["video"]]));var r=[],a=!1;a||(fetch("/idra_update",{method:"GET"}).then((function(e){if(e.ok)return e.text();throw new Error("Failed to fetch the updated content")})).then((function(e){var t=(new DOMParser).parseFromString(e,"text/html"),n=t.querySelectorAll("#datasets-list a"),o=t.querySelectorAll("#datasets-list #url");n.forEach((function(e,t){var n=e.textContent,i=o[t].textContent;r.push({title:n,url:i})}))})).catch((function(e){console.error("Error updating partial view:",e)})),a=!0);var l={linebreak:{},toolbar:{container:o,handlers:{linebreak:B.Z,savedDataset:function(){var e=document.createElement("div");e.classList.add("modal-container");var t=document.createElement("div");t.classList.add("modal");var n=document.createElement("div");n.classList.add("modal-content"),n.id="modalContent";var o=document.createElement("div");o.classList.add("links-column");var i=document.createElement("h1");i.textContent="Saved Dataset",o.appendChild(i),i.className="text-center";var a=document.createElement("h5");a.textContent="Select a dataset to insert in text editor:",a.style.color="gray",o.appendChild(a),r.forEach((function(t){var n=document.createElement("a");n.href=t.url,n.textContent=t.title,o.appendChild(n),n.addEventListener("click",(function(n){var o,i,r,a;n.preventDefault(),o=t.title,i=t.url,r=d.getSelection(),a={link:i,target:"_blank"},d.insertText(r.index,o,a),d.setSelection(r.index,o.length,"user"),e.style.display="none"})),t!==r[r.length-1]&&o.appendChild(document.createElement("br"))})),n.appendChild(o),t.appendChild(n),e.appendChild(t),document.body.appendChild(e),e.style.display="block",window.addEventListener("click",(function(t){t.target==e&&(e.style.display="none")}))}}}},c=$(e).siblings('input[type="hidden"]');e.innerHTML=c.val()||"";var u=$('meta[name="csrf-token"]').attr("content");i&&(l.imageResize={modules:["Resize","DisplaySize"]},l.imageUpload={url:$(e).data("uploadImagesPath"),method:"POST",name:"image",withCredentials:!1,headers:{"X-CSRF-Token":u},callbackOK:function(e,t){$("div.ql-toolbar").last().removeClass("editor-loading"),t(e.url)},callbackKO:function(e){$("div.ql-toolbar").last().removeClass("editor-loading"),console.log("Image upload error: ".concat(e.message))},checkBeforeSend:function(e,t){$("div.ql-toolbar").last().addClass("editor-loading"),t(e)}});var d=new Quill(e,{modules:l,formats:L,theme:"snow"});if(n&&d.disable(),d.on("text-change",(function(){var t=d.getText(),n=new CustomEvent("quill-position",{detail:d.getSelection()});if(e.dispatchEvent(n),"\n"!==t&&"\n\n"!==t||0!==d.root.querySelectorAll("iframe").length){var o="<p><br></p>",i=d.root.innerHTML.replace(new RegExp("^".concat(o,"|").concat(o,"$"),"g"),"");c.val(i)}else c.val("")})),d.emitter.emit("editor-ready"),i){var s=$(e).data("dragAndDropHelpText");$(e).after('<p class="help-text" style="margin-top:-1.5rem;">'.concat(s,"</p>"))}return d.emitter.emit("editor-ready"),d}window.Decidim.createEditableForm=function(){var e=".questionnaire-question",t=".questionnaire-question-answer-option",n=".questionnaire-question-answer-options",o=".remove-answer-option",i=".questionnaire-question-matrix-row",a=".questionnaire-question-matrix-rows",l=".remove-matrix-row",u=".questionnaire-question-max-choices",d=".questionnaire-question-display-condition",f=".questionnaire-question-display-conditions",p=".remove-display-condition",v="select[name$=\\[decidim_condition_question_id\\]]",h="select[name$=\\[condition_type\\]]",y="input[name$=\\[deleted\\]]",S=new b({listSelector:".questionnaire-question:not(.hidden)",hideOnFirstSelector:".move-up-question",hideOnLastSelector:".move-down-question"}),w=new g({listSelector:".questionnaire-question:not(.hidden)",labelSelector:".card-title span:first",onPositionComputed:function(t,n){$(t).find("input[name$=\\[position\\]]:not([name*=\\[matrix_rows\\]])").val(n),S.run(),$(e).each((function(e,t){var n=$(t);e?(n.find(f).find(y).val("false"),n.find(f).show()):(n.find(f).find(y).val("true"),n.find(f).hide())}))}}),F=["single_option","multiple_option","sorting","matrix_single","matrix_multiple"],q=["matrix_single","matrix_multiple"],_=function(){new k(".questionnaire-questions-list:not(.published)",{handle:".question-divider",placeholder:'<div style="border-style: dashed; border-color: #000"></div>',forcePlaceholderSize:!0,onSortUpdate:function(){w.run(),S.run()}})},T=function(e){var t,n="#".concat(e," .question-title-statement"),o=$(n).data("locale"),i=$(n).data("max-length"),r=$(n).data("omission"),a=$(n).data("placeholder");return t={inputSelector:"#".concat(e," input[name$=\\[body_").concat(o,"\\]]"),targetSelector:n,maxLength:i,omission:r,placeholder:a},new m(t)},E=function(i){var a=function(t){return new r({wrapperSelector:e,listSelector:"#".concat(t," ").concat(n," .questionnaire-question-answer-option:not(.hidden)"),minItems:2,hideOnMinItemsOrLessSelector:o})}(i),l=function(t){return new c({wrapperSelector:e,selectSelector:"".concat(u," select"),listSelector:"#".concat(t," ").concat(n," .questionnaire-question-answer-option:not(.hidden)")})}(i);return O({placeholderId:"questionnaire-question-answer-option-id",wrapperSelector:"#".concat(i," ").concat(n),containerSelector:".questionnaire-question-answer-options-list",fieldSelector:t,addFieldButtonSelector:".add-answer-option",fieldTemplateSelector:".decidim-answer-option-template",removeFieldButtonSelector:o,onAddField:function(){a.run(),l.run()},onRemoveField:function(){a.run(),l.run()}})},C={},x={},P=function(e){return F.indexOf(e)>=0},j=function(e){return q.indexOf(e)>=0},B=function(e){var t=e.options[e.selectedIndex];return $(t).data("type")},D=function(e){var t=e.find(v),n=B(t[0]),o=P(n),i=["answered","not_answered"];o&&(i.push("equal"),i.push("not_equal")),i.push("match");var r=e.find(h);r.find("option").each((function(e,t){var n=$(t),o=n.val();o&&(n.show(),i.indexOf(o)<0&&n.hide())})),i.indexOf(r.val())<0&&r.val(i[0]),r.trigger("change")},I=function(e){var t=e.find(h).val(),n=e.find(".questionnaire-question-display-condition-value"),o=e.find(".questionnaire-question-display-condition-answer-option"),i=e.find(v),r=B(i[0]),a=P(r);"match"===t?n.show():n.hide(),!a||"not_equal"!==t&&"equal"!==t?o.hide():o.show()},L=function(e){var t=function(e){return new s({source:e.find(v),select:e.find("select[name$=\\[decidim_answer_option_id\\]]"),sourceToParams:function(e){return{id:e.val()}}})}(e);t.run(),e.find(v).on("change",(function(){D(e)})),e.find(h).on("change",(function(){I(e)})),I(e),D(e)},U={},R=function(o){var r=o.attr("id"),c=o.find("select[name$=\\[question_type\\]]");!function(e){var t=e.find(".collapsible");if(t.length>0){var n=t.attr("id").replace("-question-card",""),o="".concat(n,"-question-card button--collapse-question-").concat(n," button--expand-question-").concat(n);e.find(".question--collapse").data("toggle",o)}}(o),T(r),A({controllerField:c,wrapperSelector:e,dependentFieldsSelector:n,dependentInputSelector:"".concat(t," input"),enablingCondition:function(e){return P(e.val())}}),A({controllerField:c,wrapperSelector:e,dependentFieldsSelector:u,dependentInputSelector:"select",enablingCondition:function(e){return"multiple_option"===e.val()||"matrix_multiple"===e.val()}}),A({controllerField:c,wrapperSelector:e,dependentFieldsSelector:a,dependentInputSelector:"".concat(i," input"),enablingCondition:function(e){return j(e.val())}}),C[r]=E(r),x[r]=function(e){return O({placeholderId:"questionnaire-question-matrix-row-id",wrapperSelector:"#".concat(e," ").concat(a),containerSelector:".questionnaire-question-matrix-rows-list",fieldSelector:i,addFieldButtonSelector:".add-matrix-row",fieldTemplateSelector:".decidim-matrix-row-template",removeFieldButtonSelector:l,onAddField:function(){},onRemoveField:function(){}})}(r),U[r]=function(e){return O({placeholderId:"questionnaire-question-display-condition-id",wrapperSelector:"#".concat(e," ").concat(f),containerSelector:".questionnaire-question-display-conditions-list",fieldSelector:d,addFieldButtonSelector:".add-display-condition",removeFieldButtonSelector:p,onAddField:function(e){L(e)},onRemoveField:function(){}})}(r);var s=C[r],m=x[r],v=function(){P(c.val())&&(0===c.parents(e).find(t).length&&(s._addField(),s._addField()));j(c.val())&&(0===c.parents(e).find(i).length&&(m._addField(),m._addField()))};c.on("change",v),v()};O({placeholderId:"questionnaire-question-id",wrapperSelector:".questionnaire-questions",containerSelector:".questionnaire-questions-list",fieldSelector:e,addFieldButtonSelector:".add-question",addSeparatorButtonSelector:".add-separator",addTitleAndDescriptionButtonSelector:".add-title-and-description",fieldTemplateSelector:".decidim-question-template",separatorTemplateSelector:".decidim-separator-template",TitleAndDescriptionTemplateSelector:".decidim-title-and-description-template",removeFieldButtonSelector:".remove-question",moveUpFieldButtonSelector:".move-up-question",moveDownFieldButtonSelector:".move-down-question",onAddField:function(e){R(e),_(),e.find(".editor-container").each((function(e,t){M(t)})),w.run(),S.run(),e.find("select.language-change").toArray().forEach((function(e){e.addEventListener("change",(function(){var t=e.value,n=e.parentElement.parentElement.nextElementSibling;n.querySelector(".is-active").classList.remove("is-active"),n.querySelector(t).classList.add("is-active")}))}))},onRemoveField:function(e){w.run(),S.run(),e.find(o).each((function(t,n){C[e.attr("id")]._removeField(n)})),e.find(l).each((function(t,n){x[e.attr("id")]._removeField(n)})),e.find(p).each((function(t,n){U[e.attr("id")]._removeField(n)}))},onMoveUpField:function(){w.run(),S.run()},onMoveDownField:function(){w.run(),S.run()}}),_(),$(e).each((function(e,t){var n=$(t);!function(e){"true"===e.find("input[name$=\\[deleted\\]]").val()&&(e.addClass("hidden"),e.hide())}(n),R(n)})),$(d).each((function(e,t){var n=$(t);L(n)})),w.run(),S.run()}},77474:function(){window,$("button.collapse-all").on("click",(function(){$(".collapsible").addClass("hide"),$(".question--collapse .icon-expand").removeClass("hide"),$(".question--collapse .icon-collapse").addClass("hide")})),$("button.expand-all").on("click",(function(){$(".collapsible").removeClass("hide"),$(".question--collapse .icon-expand").addClass("hide"),$(".question--collapse .icon-collapse").removeClass("hide")}))}},n={};function o(e){var i=n[e];if(void 0!==i)return i.exports;var r=n[e]={id:e,loaded:!1,exports:{}};return t[e].call(r.exports,r,r.exports,o),r.loaded=!0,r.exports}o.m=t,e=[],o.O=function(t,n,i,r){if(!n){var a=1/0;for(d=0;d<e.length;d++){n=e[d][0],i=e[d][1],r=e[d][2];for(var l=!0,c=0;c<n.length;c++)(!1&r||a>=r)&&Object.keys(o.O).every((function(e){return o.O[e](n[c])}))?n.splice(c--,1):(l=!1,r<a&&(a=r));if(l){e.splice(d--,1);var u=i();void 0!==u&&(t=u)}}return t}r=r||0;for(var d=e.length;d>0&&e[d-1][2]>r;d--)e[d]=e[d-1];e[d]=[n,i,r]},o.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return o.d(t,{a:t}),t},o.d=function(e,t){for(var n in t)o.o(t,n)&&!o.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},o.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},o.nmd=function(e){return e.paths=[],e.children||(e.children=[]),e},function(){var e={9985:0};o.O.j=function(t){return 0===e[t]};var t=function(t,n){var i,r,a=n[0],l=n[1],c=n[2],u=0;if(a.some((function(t){return 0!==e[t]}))){for(i in l)o.o(l,i)&&(o.m[i]=l[i]);if(c)var d=c(o)}for(t&&t(n);u<a.length;u++)r=a[u],o.o(e,r)&&e[r]&&e[r][0](),e[r]=0;return o.O(d)},n=self.webpackChunkdecidim_app=self.webpackChunkdecidim_app||[];n.forEach(t.bind(null,0)),n.push=t.bind(null,n.push.bind(n))}();var i=o.O(void 0,[2415,4112,2639],(function(){return o(34281)}));i=o.O(i)}();
//# sourceMappingURL=decidim_forms_admin-49b4677d2a679cb3e693.js.map