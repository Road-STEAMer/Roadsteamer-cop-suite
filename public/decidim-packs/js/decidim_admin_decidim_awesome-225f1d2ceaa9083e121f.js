!function(){var e,t={51527:function(e,t,n){"use strict";n(26987),n(22478),n(80327),n(40686);$((function(){$("select.multiusers-select").each((function(){var e=$(this).attr("data-url");$(this).select2({ajax:{url:e,delay:100,dataType:"json",processResults:function(e){return{results:e}}},escapeMarkup:function(e){return e},templateSelection:function(e){return"".concat(e.text)},minimumInputLength:1,theme:"foundation"})}))})),$((function(){var e=$("#config_additional_proposal_sortings");e.select2({theme:"foundation"}),$("#additional_proposal_sortings-enable-all").on("click",(function(t){t.preventDefault(),e.find("option").prop("selected",!0),e.trigger("change")}))}));n(23849);var a=n(4631),o=n.n(a);n(36629),n(23412);$((function(){$(".awesome-edit-config .scoped_styles_container textarea").each((function(e,t){o().fromTextArea(t,{lineNumbers:!0,mode:"css",keymap:"sublime"})}))}));n(43154);var r=n(21351),i=n(78153),c=n.n(i),l=n(97046),d=n.n(l),s=(n(75990),n(2299),n(96083),n(20637)),u=(n(7480),n(35021),n(99712),n(83730),n(87441));function f(e){return function(e){if(Array.isArray(e))return m(e)}(e)||function(e){if("undefined"!==typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"===typeof e)return m(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return m(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function m(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,a=new Array(t);n<t;n++)a[n]=e[n];return a}var p=window.DecidimAwesome||{},h=["bold","italic","link","underline","header","list","video","image","alt","break","width","style","code","blockquote","indent"];function v(e){var t=$(e).data("toolbar"),n=$(e).data("disabled"),a=[["bold","italic","underline","linebreak"],[{list:"ordered"},{list:"bullet"}],["link","clean"],["code","blockquote"],[{indent:"-1"},{indent:"+1"}],[{savedDataset:"openModal"}]],o=$(e).data("editorImages");"full"===t?a=[[{header:[2,3,4,5,6,!1]}]].concat(f(a),[["video"]]):"basic"===t&&(a=[].concat(f(a),[["video"]]));var i=[],c=!1;c||(fetch("/idra_update",{method:"GET"}).then((function(e){if(e.ok)return e.text();throw new Error("Failed to fetch the updated content")})).then((function(e){var t=(new DOMParser).parseFromString(e,"text/html"),n=t.querySelectorAll("#datasets-list a"),a=t.querySelectorAll("#datasets-list #url");n.forEach((function(e,t){var n=e.textContent,o=a[t].textContent;i.push({title:n,url:o})}))})).catch((function(e){console.error("Error updating partial view:",e)})),c=!0);var l={linebreak:{},toolbar:{container:a,handlers:{linebreak:r.Z,savedDataset:function(){var e=document.createElement("div");e.classList.add("modal-container");var t=document.createElement("div");t.classList.add("modal");var n=document.createElement("div");n.classList.add("modal-content"),n.id="modalContent";var a=document.createElement("div");a.classList.add("links-column");var o=document.createElement("h1");o.textContent="Saved Dataset",a.appendChild(o),o.className="text-center";var r=document.createElement("h5");r.textContent="Select a dataset to insert in text editor:",r.style.color="gray",a.appendChild(r),i.forEach((function(t){var n=document.createElement("a");n.href=t.url,n.textContent=t.title,a.appendChild(n),n.addEventListener("click",(function(n){var a,o,r,i;n.preventDefault(),a=t.title,o=t.url,r=u.getSelection(),i={link:o,target:"_blank"},u.insertText(r.index,a,i),u.setSelection(r.index,a.length,"user"),e.style.display="none"})),t!==i[i.length-1]&&a.appendChild(document.createElement("br"))})),n.appendChild(a),t.appendChild(n),e.appendChild(t),document.body.appendChild(e),e.style.display="block",window.addEventListener("click",(function(t){t.target==e&&(e.style.display="none")}))}}}},d=$(e).siblings('input[type="hidden"]');e.innerHTML=d.val()||"";var s=$('meta[name="csrf-token"]').attr("content");o&&(l.imageResize={modules:["Resize","DisplaySize"]},l.imageUpload={url:$(e).data("uploadImagesPath"),method:"POST",name:"image",withCredentials:!1,headers:{"X-CSRF-Token":s},callbackOK:function(e,t){$("div.ql-toolbar").last().removeClass("editor-loading"),t(e.url)},callbackKO:function(e){$("div.ql-toolbar").last().removeClass("editor-loading"),console.log("Image upload error: ".concat(e.message))},checkBeforeSend:function(e,t){$("div.ql-toolbar").last().addClass("editor-loading"),t(e)}});var u=new Quill(e,{modules:l,formats:h,theme:"snow"});if(n&&u.disable(),u.on("text-change",(function(){var t=u.getText(),n=new CustomEvent("quill-position",{detail:u.getSelection()});if(e.dispatchEvent(n),"\n"!==t&&"\n\n"!==t||0!==u.root.querySelectorAll("iframe").length){var a="<p><br></p>",o=u.root.innerHTML.replace(new RegExp("^".concat(a,"|").concat(a,"$"),"g"),"");d.val(o)}else d.val("")})),u.emitter.emit("editor-ready"),o){var m=$(e).data("dragAndDropHelpText");$(e).after('<p class="help-text" style="margin-top:-1.5rem;">'.concat(m,"</p>"))}return u.emitter.emit("editor-ready"),u}$((function(){$(".editor-container").each((function(e,t){!function(e){if(e){var t=$(e).find(".ql-editor").html();$(e).html(t),$(e).siblings(".ql-toolbar").remove(),$(e).find("*[class*='ql-']").removeClass((function(e,t){return(t.match(/(^|\s)ql-\S+/g)||[]).join(" ")})),$(e).removeClass((function(e,t){return(t.match(/(^|\s)ql-\S+/g)||[]).join(" ")})),$(e).next().is("p.help-text")&&$(e).next().remove()}else console.error("editor [".concat(e,"] not exists"))}(t),window.DecidimAwesome.use_markdown_editor?function(e){var t=p.texts.drag_and_drop_image,n=$('meta[name="csrf-token"]').attr("content"),a=$(e).siblings('input[type="hidden"]'),o=$('<textarea name="faker-inscrybmde"/>'),r=$(e).closest("form"),i=new(d());o.val(i.convert(a.val())),o.insertBefore($(e)),$(e).hide();var l=new(c())({element:o[0],spellChecker:!1,renderingConfig:{codeSyntaxHighlighting:!0,hljs:s.Z}});o[0].InscrybMDE=l,p.allow_images_in_markdown_editor&&($(l.gui.statusbar).prepend('<span class="help-text" style="float:left;margin:0;text-align:left;">'.concat(t,"</span>")),window.inlineAttachment.editors.codemirror4.attach(l.codemirror,{uploadUrl:p.editor_uploader_path,uploadFieldName:"image",jsonFieldName:"url",extraHeaders:{"X-CSRF-Token":n}})),u.TU.setOptions({breaks:!0}),r.on("submit",(function(){a.val((0,u.TU)(l.value()))}))}(t):v(t)}))}));n(62526)},80327:function(){$((function(){var e=window.CustomFieldsBuilders||[];$("body").on("click","a.awesome-auto-edit",(function(t){t.preventDefault();var n=$(t.currentTarget),a=n.data("scope"),o=$('span.awesome-auto-edit[data-scope="'.concat(a,'"]')),r=$('.constraints-editor[data-key="'.concat(a,'"]'));if(0!==o.length){var i=o.data("key"),c=o.data("var"),l=$('[name="config['.concat(c,"][").concat(i,']"]')),d=$('[name="config['.concat(c,"][").concat(i,'][]"]')),s=$(".".concat(c,'_container[data-key="').concat(i,'"]')),u=$(".delete-box",s),f=function(e,t){o.text(e),o.attr("data-key",e),o.data("key",e),t&&(o.attr("data-scope",t),o.data("scope",t),n.attr("data-scope",t),n.data("scope",t)),n.show()};o.html('<input class="awesome-auto-edit" data-scope="'.concat(a,'" type="text" value="').concat(i,'">'));var m=$('input.awesome-auto-edit[data-scope="'.concat(a,'"]'));n.hide(),m.select(),m.on("keypress",(function(t){"Enter"!==t.code&&"13"!==t.code&&"10"!==t.code||(t.preventDefault(),$.ajax({type:"POST",url:window.DecidimAwesome.rename_scope_label_path,dataType:"json",headers:{"X-CSRF-Token":$("meta[name=csrf-token]").attr("content")},data:{key:i,scope:a,attribute:c,text:m.val()}}).done((function(t){return function(t){f(t.key,t.scope),r.replaceWith(t.html),l.attr("name","config[".concat(c,"][").concat(t.key,"]")),d.attr("name","config[".concat(c,"][").concat(t.key,"][]")),s.data("key",t.key),s.attr("data-key",t.key),u.attr("href",u.attr("href").replace("key=".concat(i),"key=".concat(t.key))),e.forEach((function(e){e.key===i&&(e.key=t.key)}))}(t)})).fail((function(e){console.error("Error saving key",i,"ERR:",e),f(i)})))})),m.on("blur",(function(){f(i)}))}}))}))},43154:function(){$((function(){$(".check-custom-redirections").on("click",(function(e){if(e.preventDefault(),!$(e.target).hasClass("disabled")){$(e.target).addClass("disabled");$("tr.custom-redirection").each((function(e,t){var n=$(t).find(".redirect-status");n.html('<span class="loading-spinner" />'),fetch($(t).data("origin"),{method:"HEAD",redirect:"manual"}).then((function(e){n.html(function(e,t){var n=$(e).data("item"),a=$(e).find(".redirect-status"),o=t.type,r=t.status;return"opaqueredirect"===t.type&&(o="redirect",r="302"),n.active?"redirect"===o?a.addClass("success"):a.addClass("alert"):a.addClass("muted"),"".concat(o," (").concat(r,")")}(t,e))})).catch((function(e){console.error("ERROR",e),n.removeClass("loading")}))}))}}))}))},22478:function(){$((function(){var e=$("#constraintsModal");e.length&&($(".decidim_awesome-form").on("click",".constraints-editor .add-condition,.constraints-editor .edit-condition",(function(t){t.preventDefault();var n=$(t.target),a=n.attr("href"),o=n.closest(".constraints-editor").find(".callout");o.hide(),o.removeClass("alert success"),e.find(".modal-content").html(""),e.addClass("loading"),e.data("url",a),e.foundation("open"),e.find(".modal-content").load(a,(function(){e.removeClass("loading")}))})),document.body.addEventListener("constraint:change",(function(t){var n=t.detail.map((function(e){return"".concat(e.key,"=").concat(e.value)})),a="".concat(e.data("url"),"&").concat(n.join("&"));e.addClass("loading"),e.find(".modal-content").load(a,(function(){e.removeClass("loading")}))})),document.body.addEventListener("ajax:error",(function(e){var t=$('.constraints-editor[data-key="'.concat(e.detail[0].key,'"]')).find(".callout");t.show(),t.contents("p").html("".concat(e.detail[0].message,": <strong>").concat(e.detail[0].error,"</strong>")),t.addClass("alert")})),document.body.addEventListener("ajax:success",(function(t){var n=$('.constraints-editor[data-key="'.concat(t.detail[0].key,'"]')),a=n.find(".callout");e.foundation("close"),a.show(),a.contents("p").html(t.detail[0].message),a.addClass("success"),n.replaceWith(t.detail[0].html)})))}))},23849:function(){$((function(){$("[data-tabs]").on("change.zf.tabs",(function(e){var t=$(e.target).closest(".label--tabs").next(".tabs-content").find(".tabs-panel.is-active"),n=t.find('[name="faker-inscrybmde"]');n.length>0&&n[0].InscrybMDE.codemirror.refresh(),(n=t.find(".proposal_custom_field:first")).length>0&&(window.DecidimAwesome.CustomFieldsRenderer.storeData(),window.DecidimAwesome.CustomFieldsRenderer.init(n))}))}))},62562:function(){}},n={};function a(e){var o=n[e];if(void 0!==o)return o.exports;var r=n[e]={id:e,loaded:!1,exports:{}};return t[e].call(r.exports,r,r.exports,a),r.loaded=!0,r.exports}a.m=t,e=[],a.O=function(t,n,o,r){if(!n){var i=1/0;for(s=0;s<e.length;s++){n=e[s][0],o=e[s][1],r=e[s][2];for(var c=!0,l=0;l<n.length;l++)(!1&r||i>=r)&&Object.keys(a.O).every((function(e){return a.O[e](n[l])}))?n.splice(l--,1):(c=!1,r<i&&(i=r));if(c){e.splice(s--,1);var d=o();void 0!==d&&(t=d)}}return t}r=r||0;for(var s=e.length;s>0&&e[s-1][2]>r;s--)e[s]=e[s-1];e[s]=[n,o,r]},a.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return a.d(t,{a:t}),t},a.d=function(e,t){for(var n in t)a.o(t,n)&&!a.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},a.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}(),a.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},a.nmd=function(e){return e.paths=[],e.children||(e.children=[]),e},function(){var e={4950:0};a.O.j=function(t){return 0===e[t]};var t=function(t,n){var o,r,i=n[0],c=n[1],l=n[2],d=0;if(i.some((function(t){return 0!==e[t]}))){for(o in c)a.o(c,o)&&(a.m[o]=c[o]);if(l)var s=l(a)}for(t&&t(n);d<i.length;d++)r=i[d],a.o(e,r)&&e[r]&&e[r][0](),e[r]=0;return a.O(s)},n=self.webpackChunkdecidim_app=self.webpackChunkdecidim_app||[];n.forEach(t.bind(null,0)),n.push=t.bind(null,n.push.bind(n))}();var o=a.O(void 0,[2415,6795,292,4112,6690,9281,2619,596,7418,2639,9093,3072,518,5598],(function(){return a(51527)}));o=a.O(o)}();
//# sourceMappingURL=decidim_admin_decidim_awesome-225f1d2ceaa9083e121f.js.map