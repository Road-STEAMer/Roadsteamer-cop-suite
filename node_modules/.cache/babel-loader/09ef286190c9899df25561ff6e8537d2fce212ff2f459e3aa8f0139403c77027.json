{"ast":null,"code":"function _typeof(obj) {\n  \"@babel/helpers - typeof\";\n\n  return _typeof = \"function\" == typeof Symbol && \"symbol\" == typeof Symbol.iterator ? function (obj) {\n    return typeof obj;\n  } : function (obj) {\n    return obj && \"function\" == typeof Symbol && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj;\n  }, _typeof(obj);\n}\nfunction _regeneratorRuntime() {\n  \"use strict\";\n\n  /*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/facebook/regenerator/blob/main/LICENSE */\n  _regeneratorRuntime = function _regeneratorRuntime() {\n    return exports;\n  };\n  var exports = {},\n    Op = Object.prototype,\n    hasOwn = Op.hasOwnProperty,\n    defineProperty = Object.defineProperty || function (obj, key, desc) {\n      obj[key] = desc.value;\n    },\n    $Symbol = \"function\" == typeof Symbol ? Symbol : {},\n    iteratorSymbol = $Symbol.iterator || \"@@iterator\",\n    asyncIteratorSymbol = $Symbol.asyncIterator || \"@@asyncIterator\",\n    toStringTagSymbol = $Symbol.toStringTag || \"@@toStringTag\";\n  function define(obj, key, value) {\n    return Object.defineProperty(obj, key, {\n      value: value,\n      enumerable: !0,\n      configurable: !0,\n      writable: !0\n    }), obj[key];\n  }\n  try {\n    define({}, \"\");\n  } catch (err) {\n    define = function define(obj, key, value) {\n      return obj[key] = value;\n    };\n  }\n  function wrap(innerFn, outerFn, self, tryLocsList) {\n    var protoGenerator = outerFn && outerFn.prototype instanceof Generator ? outerFn : Generator,\n      generator = Object.create(protoGenerator.prototype),\n      context = new Context(tryLocsList || []);\n    return defineProperty(generator, \"_invoke\", {\n      value: makeInvokeMethod(innerFn, self, context)\n    }), generator;\n  }\n  function tryCatch(fn, obj, arg) {\n    try {\n      return {\n        type: \"normal\",\n        arg: fn.call(obj, arg)\n      };\n    } catch (err) {\n      return {\n        type: \"throw\",\n        arg: err\n      };\n    }\n  }\n  exports.wrap = wrap;\n  var ContinueSentinel = {};\n  function Generator() {}\n  function GeneratorFunction() {}\n  function GeneratorFunctionPrototype() {}\n  var IteratorPrototype = {};\n  define(IteratorPrototype, iteratorSymbol, function () {\n    return this;\n  });\n  var getProto = Object.getPrototypeOf,\n    NativeIteratorPrototype = getProto && getProto(getProto(values([])));\n  NativeIteratorPrototype && NativeIteratorPrototype !== Op && hasOwn.call(NativeIteratorPrototype, iteratorSymbol) && (IteratorPrototype = NativeIteratorPrototype);\n  var Gp = GeneratorFunctionPrototype.prototype = Generator.prototype = Object.create(IteratorPrototype);\n  function defineIteratorMethods(prototype) {\n    [\"next\", \"throw\", \"return\"].forEach(function (method) {\n      define(prototype, method, function (arg) {\n        return this._invoke(method, arg);\n      });\n    });\n  }\n  function AsyncIterator(generator, PromiseImpl) {\n    function invoke(method, arg, resolve, reject) {\n      var record = tryCatch(generator[method], generator, arg);\n      if (\"throw\" !== record.type) {\n        var result = record.arg,\n          value = result.value;\n        return value && \"object\" == _typeof(value) && hasOwn.call(value, \"__await\") ? PromiseImpl.resolve(value.__await).then(function (value) {\n          invoke(\"next\", value, resolve, reject);\n        }, function (err) {\n          invoke(\"throw\", err, resolve, reject);\n        }) : PromiseImpl.resolve(value).then(function (unwrapped) {\n          result.value = unwrapped, resolve(result);\n        }, function (error) {\n          return invoke(\"throw\", error, resolve, reject);\n        });\n      }\n      reject(record.arg);\n    }\n    var previousPromise;\n    defineProperty(this, \"_invoke\", {\n      value: function value(method, arg) {\n        function callInvokeWithMethodAndArg() {\n          return new PromiseImpl(function (resolve, reject) {\n            invoke(method, arg, resolve, reject);\n          });\n        }\n        return previousPromise = previousPromise ? previousPromise.then(callInvokeWithMethodAndArg, callInvokeWithMethodAndArg) : callInvokeWithMethodAndArg();\n      }\n    });\n  }\n  function makeInvokeMethod(innerFn, self, context) {\n    var state = \"suspendedStart\";\n    return function (method, arg) {\n      if (\"executing\" === state) throw new Error(\"Generator is already running\");\n      if (\"completed\" === state) {\n        if (\"throw\" === method) throw arg;\n        return doneResult();\n      }\n      for (context.method = method, context.arg = arg;;) {\n        var delegate = context.delegate;\n        if (delegate) {\n          var delegateResult = maybeInvokeDelegate(delegate, context);\n          if (delegateResult) {\n            if (delegateResult === ContinueSentinel) continue;\n            return delegateResult;\n          }\n        }\n        if (\"next\" === context.method) context.sent = context._sent = context.arg;else if (\"throw\" === context.method) {\n          if (\"suspendedStart\" === state) throw state = \"completed\", context.arg;\n          context.dispatchException(context.arg);\n        } else \"return\" === context.method && context.abrupt(\"return\", context.arg);\n        state = \"executing\";\n        var record = tryCatch(innerFn, self, context);\n        if (\"normal\" === record.type) {\n          if (state = context.done ? \"completed\" : \"suspendedYield\", record.arg === ContinueSentinel) continue;\n          return {\n            value: record.arg,\n            done: context.done\n          };\n        }\n        \"throw\" === record.type && (state = \"completed\", context.method = \"throw\", context.arg = record.arg);\n      }\n    };\n  }\n  function maybeInvokeDelegate(delegate, context) {\n    var methodName = context.method,\n      method = delegate.iterator[methodName];\n    if (undefined === method) return context.delegate = null, \"throw\" === methodName && delegate.iterator[\"return\"] && (context.method = \"return\", context.arg = undefined, maybeInvokeDelegate(delegate, context), \"throw\" === context.method) || \"return\" !== methodName && (context.method = \"throw\", context.arg = new TypeError(\"The iterator does not provide a '\" + methodName + \"' method\")), ContinueSentinel;\n    var record = tryCatch(method, delegate.iterator, context.arg);\n    if (\"throw\" === record.type) return context.method = \"throw\", context.arg = record.arg, context.delegate = null, ContinueSentinel;\n    var info = record.arg;\n    return info ? info.done ? (context[delegate.resultName] = info.value, context.next = delegate.nextLoc, \"return\" !== context.method && (context.method = \"next\", context.arg = undefined), context.delegate = null, ContinueSentinel) : info : (context.method = \"throw\", context.arg = new TypeError(\"iterator result is not an object\"), context.delegate = null, ContinueSentinel);\n  }\n  function pushTryEntry(locs) {\n    var entry = {\n      tryLoc: locs[0]\n    };\n    1 in locs && (entry.catchLoc = locs[1]), 2 in locs && (entry.finallyLoc = locs[2], entry.afterLoc = locs[3]), this.tryEntries.push(entry);\n  }\n  function resetTryEntry(entry) {\n    var record = entry.completion || {};\n    record.type = \"normal\", delete record.arg, entry.completion = record;\n  }\n  function Context(tryLocsList) {\n    this.tryEntries = [{\n      tryLoc: \"root\"\n    }], tryLocsList.forEach(pushTryEntry, this), this.reset(!0);\n  }\n  function values(iterable) {\n    if (iterable) {\n      var iteratorMethod = iterable[iteratorSymbol];\n      if (iteratorMethod) return iteratorMethod.call(iterable);\n      if (\"function\" == typeof iterable.next) return iterable;\n      if (!isNaN(iterable.length)) {\n        var i = -1,\n          next = function next() {\n            for (; ++i < iterable.length;) if (hasOwn.call(iterable, i)) return next.value = iterable[i], next.done = !1, next;\n            return next.value = undefined, next.done = !0, next;\n          };\n        return next.next = next;\n      }\n    }\n    return {\n      next: doneResult\n    };\n  }\n  function doneResult() {\n    return {\n      value: undefined,\n      done: !0\n    };\n  }\n  return GeneratorFunction.prototype = GeneratorFunctionPrototype, defineProperty(Gp, \"constructor\", {\n    value: GeneratorFunctionPrototype,\n    configurable: !0\n  }), defineProperty(GeneratorFunctionPrototype, \"constructor\", {\n    value: GeneratorFunction,\n    configurable: !0\n  }), GeneratorFunction.displayName = define(GeneratorFunctionPrototype, toStringTagSymbol, \"GeneratorFunction\"), exports.isGeneratorFunction = function (genFun) {\n    var ctor = \"function\" == typeof genFun && genFun.constructor;\n    return !!ctor && (ctor === GeneratorFunction || \"GeneratorFunction\" === (ctor.displayName || ctor.name));\n  }, exports.mark = function (genFun) {\n    return Object.setPrototypeOf ? Object.setPrototypeOf(genFun, GeneratorFunctionPrototype) : (genFun.__proto__ = GeneratorFunctionPrototype, define(genFun, toStringTagSymbol, \"GeneratorFunction\")), genFun.prototype = Object.create(Gp), genFun;\n  }, exports.awrap = function (arg) {\n    return {\n      __await: arg\n    };\n  }, defineIteratorMethods(AsyncIterator.prototype), define(AsyncIterator.prototype, asyncIteratorSymbol, function () {\n    return this;\n  }), exports.AsyncIterator = AsyncIterator, exports.async = function (innerFn, outerFn, self, tryLocsList, PromiseImpl) {\n    void 0 === PromiseImpl && (PromiseImpl = Promise);\n    var iter = new AsyncIterator(wrap(innerFn, outerFn, self, tryLocsList), PromiseImpl);\n    return exports.isGeneratorFunction(outerFn) ? iter : iter.next().then(function (result) {\n      return result.done ? result.value : iter.next();\n    });\n  }, defineIteratorMethods(Gp), define(Gp, toStringTagSymbol, \"Generator\"), define(Gp, iteratorSymbol, function () {\n    return this;\n  }), define(Gp, \"toString\", function () {\n    return \"[object Generator]\";\n  }), exports.keys = function (val) {\n    var object = Object(val),\n      keys = [];\n    for (var key in object) keys.push(key);\n    return keys.reverse(), function next() {\n      for (; keys.length;) {\n        var key = keys.pop();\n        if (key in object) return next.value = key, next.done = !1, next;\n      }\n      return next.done = !0, next;\n    };\n  }, exports.values = values, Context.prototype = {\n    constructor: Context,\n    reset: function reset(skipTempReset) {\n      if (this.prev = 0, this.next = 0, this.sent = this._sent = undefined, this.done = !1, this.delegate = null, this.method = \"next\", this.arg = undefined, this.tryEntries.forEach(resetTryEntry), !skipTempReset) for (var name in this) \"t\" === name.charAt(0) && hasOwn.call(this, name) && !isNaN(+name.slice(1)) && (this[name] = undefined);\n    },\n    stop: function stop() {\n      this.done = !0;\n      var rootRecord = this.tryEntries[0].completion;\n      if (\"throw\" === rootRecord.type) throw rootRecord.arg;\n      return this.rval;\n    },\n    dispatchException: function dispatchException(exception) {\n      if (this.done) throw exception;\n      var context = this;\n      function handle(loc, caught) {\n        return record.type = \"throw\", record.arg = exception, context.next = loc, caught && (context.method = \"next\", context.arg = undefined), !!caught;\n      }\n      for (var i = this.tryEntries.length - 1; i >= 0; --i) {\n        var entry = this.tryEntries[i],\n          record = entry.completion;\n        if (\"root\" === entry.tryLoc) return handle(\"end\");\n        if (entry.tryLoc <= this.prev) {\n          var hasCatch = hasOwn.call(entry, \"catchLoc\"),\n            hasFinally = hasOwn.call(entry, \"finallyLoc\");\n          if (hasCatch && hasFinally) {\n            if (this.prev < entry.catchLoc) return handle(entry.catchLoc, !0);\n            if (this.prev < entry.finallyLoc) return handle(entry.finallyLoc);\n          } else if (hasCatch) {\n            if (this.prev < entry.catchLoc) return handle(entry.catchLoc, !0);\n          } else {\n            if (!hasFinally) throw new Error(\"try statement without catch or finally\");\n            if (this.prev < entry.finallyLoc) return handle(entry.finallyLoc);\n          }\n        }\n      }\n    },\n    abrupt: function abrupt(type, arg) {\n      for (var i = this.tryEntries.length - 1; i >= 0; --i) {\n        var entry = this.tryEntries[i];\n        if (entry.tryLoc <= this.prev && hasOwn.call(entry, \"finallyLoc\") && this.prev < entry.finallyLoc) {\n          var finallyEntry = entry;\n          break;\n        }\n      }\n      finallyEntry && (\"break\" === type || \"continue\" === type) && finallyEntry.tryLoc <= arg && arg <= finallyEntry.finallyLoc && (finallyEntry = null);\n      var record = finallyEntry ? finallyEntry.completion : {};\n      return record.type = type, record.arg = arg, finallyEntry ? (this.method = \"next\", this.next = finallyEntry.finallyLoc, ContinueSentinel) : this.complete(record);\n    },\n    complete: function complete(record, afterLoc) {\n      if (\"throw\" === record.type) throw record.arg;\n      return \"break\" === record.type || \"continue\" === record.type ? this.next = record.arg : \"return\" === record.type ? (this.rval = this.arg = record.arg, this.method = \"return\", this.next = \"end\") : \"normal\" === record.type && afterLoc && (this.next = afterLoc), ContinueSentinel;\n    },\n    finish: function finish(finallyLoc) {\n      for (var i = this.tryEntries.length - 1; i >= 0; --i) {\n        var entry = this.tryEntries[i];\n        if (entry.finallyLoc === finallyLoc) return this.complete(entry.completion, entry.afterLoc), resetTryEntry(entry), ContinueSentinel;\n      }\n    },\n    \"catch\": function _catch(tryLoc) {\n      for (var i = this.tryEntries.length - 1; i >= 0; --i) {\n        var entry = this.tryEntries[i];\n        if (entry.tryLoc === tryLoc) {\n          var record = entry.completion;\n          if (\"throw\" === record.type) {\n            var thrown = record.arg;\n            resetTryEntry(entry);\n          }\n          return thrown;\n        }\n      }\n      throw new Error(\"illegal catch attempt\");\n    },\n    delegateYield: function delegateYield(iterable, resultName, nextLoc) {\n      return this.delegate = {\n        iterator: values(iterable),\n        resultName: resultName,\n        nextLoc: nextLoc\n      }, \"next\" === this.method && (this.arg = undefined), ContinueSentinel;\n    }\n  }, exports;\n}\nfunction ownKeys(object, enumerableOnly) {\n  var keys = Object.keys(object);\n  if (Object.getOwnPropertySymbols) {\n    var symbols = Object.getOwnPropertySymbols(object);\n    enumerableOnly && (symbols = symbols.filter(function (sym) {\n      return Object.getOwnPropertyDescriptor(object, sym).enumerable;\n    })), keys.push.apply(keys, symbols);\n  }\n  return keys;\n}\nfunction _objectSpread(target) {\n  for (var i = 1; i < arguments.length; i++) {\n    var source = null != arguments[i] ? arguments[i] : {};\n    i % 2 ? ownKeys(Object(source), !0).forEach(function (key) {\n      _defineProperty(target, key, source[key]);\n    }) : Object.getOwnPropertyDescriptors ? Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)) : ownKeys(Object(source)).forEach(function (key) {\n      Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key));\n    });\n  }\n  return target;\n}\nfunction _defineProperty(obj, key, value) {\n  key = _toPropertyKey(key);\n  if (key in obj) {\n    Object.defineProperty(obj, key, {\n      value: value,\n      enumerable: true,\n      configurable: true,\n      writable: true\n    });\n  } else {\n    obj[key] = value;\n  }\n  return obj;\n}\nfunction _toPropertyKey(arg) {\n  var key = _toPrimitive(arg, \"string\");\n  return _typeof(key) === \"symbol\" ? key : String(key);\n}\nfunction _toPrimitive(input, hint) {\n  if (_typeof(input) !== \"object\" || input === null) return input;\n  var prim = input[Symbol.toPrimitive];\n  if (prim !== undefined) {\n    var res = prim.call(input, hint || \"default\");\n    if (_typeof(res) !== \"object\") return res;\n    throw new TypeError(\"@@toPrimitive must return a primitive value.\");\n  }\n  return (hint === \"string\" ? String : Number)(input);\n}\nfunction asyncGeneratorStep(gen, resolve, reject, _next, _throw, key, arg) {\n  try {\n    var info = gen[key](arg);\n    var value = info.value;\n  } catch (error) {\n    reject(error);\n    return;\n  }\n  if (info.done) {\n    resolve(value);\n  } else {\n    Promise.resolve(value).then(_next, _throw);\n  }\n}\nfunction _asyncToGenerator(fn) {\n  return function () {\n    var self = this,\n      args = arguments;\n    return new Promise(function (resolve, reject) {\n      var gen = fn.apply(self, args);\n      function _next(value) {\n        asyncGeneratorStep(gen, resolve, reject, _next, _throw, \"next\", value);\n      }\n      function _throw(err) {\n        asyncGeneratorStep(gen, resolve, reject, _next, _throw, \"throw\", err);\n      }\n      _next(undefined);\n    });\n  };\n}\nimport { mergeAttributes } from \"@tiptap/core\";\nimport Image from \"@tiptap/extension-image\";\nimport { Plugin } from \"prosemirror-state\";\nimport { getDictionary } from \"src/decidim/i18n\";\nimport { fileNameToTitle } from \"src/decidim/editor/utilities/file\";\nimport createNodeView from \"src/decidim/editor/extensions/image/node_view\";\nimport UploadDialog from \"src/decidim/editor/common/upload_dialog\";\nvar createImageUploadDialog = function createImageUploadDialog(editor, _ref) {\n  var uploadDialogSelector = _ref.uploadDialogSelector;\n  var i18nUpload = getDictionary(\"editor.upload\");\n  return new UploadDialog(document.querySelector(uploadDialogSelector), {\n    i18n: i18nUpload,\n    onOpen: function onOpen() {\n      return editor.commands.toggleDialog(true);\n    },\n    onClose: function onClose() {\n      return editor.chain().toggleDialog(false).focus(null, {\n        scrollIntoView: false\n      }).run();\n    }\n  });\n};\nvar uploadImage = /*#__PURE__*/function () {\n  var _ref2 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee(image, uploadUrl) {\n    var token, data, i18n;\n    return _regeneratorRuntime().wrap(function _callee$(_context) {\n      while (1) switch (_context.prev = _context.next) {\n        case 0:\n          token = document.querySelector(\"meta[name='csrf-token']\").getAttribute(\"content\");\n          data = new FormData();\n          data.append(\"image\", image);\n          i18n = getDictionary(\"editor.extensions.image\");\n          return _context.abrupt(\"return\", new Promise(function (resolve, reject) {\n            fetch(uploadUrl, {\n              method: \"POST\",\n              mode: \"cors\",\n              cache: \"no-cache\",\n              headers: {\n                \"X-CSRF-Token\": token\n              },\n              body: data\n            }).then(function (response) {\n              if (response.ok) {\n                return response.json();\n              }\n              return new Promise(function (responseResolve) {\n                return responseResolve({\n                  message: i18n.uploadError\n                });\n              });\n            }).then(function (json) {\n              return resolve(_objectSpread({\n                title: fileNameToTitle(image.name)\n              }, json));\n            })[\"catch\"](reject);\n          }));\n        case 5:\n        case \"end\":\n          return _context.stop();\n      }\n    }, _callee);\n  }));\n  return function uploadImage(_x, _x2) {\n    return _ref2.apply(this, arguments);\n  };\n}();\nvar filterImages = function filterImages(files, contentTypes) {\n  return Array.from(files).filter(function (file) {\n    if (contentTypes instanceof RegExp) {\n      return contentTypes.test(file.type);\n    } else if (contentTypes instanceof Array) {\n      return contentTypes.includes(file.type);\n    }\n    // string\n    return contentTypes === file.type;\n  });\n};\n\n/**\n * Handles the image uploads through ActiveStorage when they are dropped or\n * pasted to the editor.\n *\n * Paste and drop handling based on:\n * https://gist.github.com/slava-vishnyakov/16076dff1a77ddaca93c4bccd4ec4521\n */\nexport default Image.extend({\n  addOptions: function addOptions() {\n    var _this$parent;\n    return _objectSpread(_objectSpread({}, (_this$parent = this.parent) === null || _this$parent === void 0 ? void 0 : _this$parent.call(this)), {}, {\n      contentTypes: /^image\\/(jpe?g|png|svg|webp)$/i,\n      uploadImagesPath: null,\n      uploadDialogSelector: null\n    });\n  },\n  addAttributes: function addAttributes() {\n    var _this$parent2;\n    return _objectSpread(_objectSpread({}, (_this$parent2 = this.parent) === null || _this$parent2 === void 0 ? void 0 : _this$parent2.call(this)), {}, {\n      width: {\n        \"default\": null\n      }\n    });\n  },\n  addCommands: function addCommands() {\n    var _this$parent3,\n      _this = this;\n    var i18n = getDictionary(\"editor.extensions.image\");\n    var uploadDialog = createImageUploadDialog(this.editor, this.options);\n    return _objectSpread(_objectSpread({}, (_this$parent3 = this.parent) === null || _this$parent3 === void 0 ? void 0 : _this$parent3.call(this)), {}, {\n      imageDialog: function imageDialog() {\n        return /*#__PURE__*/function () {\n          var _ref4 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee3(_ref3) {\n            var dispatch, _this$editor$getAttri, src, alt, width, dialogState;\n            return _regeneratorRuntime().wrap(function _callee3$(_context3) {\n              while (1) switch (_context3.prev = _context3.next) {\n                case 0:\n                  dispatch = _ref3.dispatch;\n                  if (!dispatch) {\n                    _context3.next = 15;\n                    break;\n                  }\n                  _this$editor$getAttri = _this.editor.getAttributes(\"image\"), src = _this$editor$getAttri.src, alt = _this$editor$getAttri.alt, width = _this$editor$getAttri.width;\n                  _this.editor.commands.toggleDialog(true);\n                  _context3.next = 6;\n                  return uploadDialog.toggle({\n                    src: src,\n                    alt: alt\n                  }, {\n                    inputLabel: i18n.altLabel,\n                    uploadHandler: function () {\n                      var _uploadHandler = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee2(file) {\n                        return _regeneratorRuntime().wrap(function _callee2$(_context2) {\n                          while (1) switch (_context2.prev = _context2.next) {\n                            case 0:\n                              return _context2.abrupt(\"return\", uploadImage(file, _this.options.uploadImagesPath));\n                            case 1:\n                            case \"end\":\n                              return _context2.stop();\n                          }\n                        }, _callee2);\n                      }));\n                      function uploadHandler(_x4) {\n                        return _uploadHandler.apply(this, arguments);\n                      }\n                      return uploadHandler;\n                    }()\n                  });\n                case 6:\n                  dialogState = _context3.sent;\n                  _this.editor.commands.toggleDialog(false);\n                  if (!(dialogState !== \"save\")) {\n                    _context3.next = 11;\n                    break;\n                  }\n                  _this.editor.commands.focus(null, {\n                    scrollIntoView: false\n                  });\n                  return _context3.abrupt(\"return\", false);\n                case 11:\n                  if (uploadDialog.getValue(\"src\") !== src) {\n                    // Reset the width to original width in case the image changed.\n                    width = null;\n                  }\n                  src = uploadDialog.getValue(\"src\");\n                  alt = uploadDialog.getValue(\"alt\");\n                  return _context3.abrupt(\"return\", _this.editor.chain().setImage({\n                    src: src,\n                    alt: alt,\n                    width: width\n                  }).focus(null, {\n                    scrollIntoView: false\n                  }).run());\n                case 15:\n                  return _context3.abrupt(\"return\", true);\n                case 16:\n                case \"end\":\n                  return _context3.stop();\n              }\n            }, _callee3);\n          }));\n          return function (_x3) {\n            return _ref4.apply(this, arguments);\n          };\n        }();\n      }\n    });\n  },\n  addNodeView: function addNodeView() {\n    return createNodeView(this);\n  },\n  parseHTML: function parseHTML() {\n    return [{\n      tag: \"div[data-image] img[src]:not([src^='data:'])\"\n    }];\n  },\n  renderHTML: function renderHTML(_ref5) {\n    var HTMLAttributes = _ref5.HTMLAttributes;\n    return [\"div\", {\n      \"class\": \"editor-content-image\",\n      \"data-image\": \"\"\n    }, [\"img\", mergeAttributes(this.options.HTMLAttributes, HTMLAttributes)]];\n  },\n  addProseMirrorPlugins: function addProseMirrorPlugins() {\n    var editor = this.editor;\n    var _this$options = this.options,\n      uploadImagesPath = _this$options.uploadImagesPath,\n      contentTypes = _this$options.contentTypes;\n    var handleUploadedImages = function handleUploadedImages(uploadedImages) {\n      uploadedImages.forEach(function (imageData) {\n        if (!imageData.url) {\n          return;\n        }\n        editor.commands.setImage({\n          src: imageData.url,\n          alt: imageData.title\n        });\n      });\n    };\n    return [new Plugin({\n      props: {\n        handlePaste: function handlePaste(view, event) {\n          var items = (event.clipboardData || event.originalEvent.clipboardData).items;\n          var images = filterImages(items, contentTypes);\n          if (images.length < 1) {\n            return false;\n          }\n          Promise.all(images.map(function (item) {\n            return uploadImage(item.getAsFile(), uploadImagesPath);\n          })).then(function (uploadedImages) {\n            handleUploadedImages(uploadedImages);\n          });\n          return true;\n        },\n        handleDoubleClick: function handleDoubleClick() {\n          if (!editor.isActive(\"image\")) {\n            return false;\n          }\n          editor.chain().focus().imageDialog().run();\n          return true;\n        },\n        handleDOMEvents: {\n          drop: function drop(view, event) {\n            var _event$dataTransfer;\n            var position = view.posAtCoords({\n              left: event.clientX,\n              top: event.clientY\n            });\n            var files = event === null || event === void 0 ? void 0 : (_event$dataTransfer = event.dataTransfer) === null || _event$dataTransfer === void 0 ? void 0 : _event$dataTransfer.files;\n            if (!files || files.length < 1) {\n              return;\n            }\n            var images = filterImages(files, contentTypes);\n            if (images.length < 1) {\n              return;\n            }\n            event.preventDefault();\n\n            // Make sure the image is dropped at the right place. Otherwise\n            // the image would appear at the current text selection position\n            // and always in the beginning of the content in case the editor\n            // did not have focus when the image was dropped.\n            editor.chain().focus().setTextSelection(position.pos).run();\n            Promise.all(images.map(function (image) {\n              return uploadImage(image, uploadImagesPath);\n            })).then(function (uploadedImages) {\n              handleUploadedImages(uploadedImages);\n            });\n          }\n        }\n      }\n    })];\n  }\n});","map":{"version":3,"names":["_regeneratorRuntime","exports","Op","Object","prototype","hasOwn","hasOwnProperty","defineProperty","obj","key","desc","value","$Symbol","Symbol","iteratorSymbol","iterator","asyncIteratorSymbol","asyncIterator","toStringTagSymbol","toStringTag","define","enumerable","configurable","writable","err","wrap","innerFn","outerFn","self","tryLocsList","protoGenerator","Generator","generator","create","context","Context","makeInvokeMethod","tryCatch","fn","arg","type","call","ContinueSentinel","GeneratorFunction","GeneratorFunctionPrototype","IteratorPrototype","getProto","getPrototypeOf","NativeIteratorPrototype","values","Gp","defineIteratorMethods","forEach","method","_invoke","AsyncIterator","PromiseImpl","invoke","resolve","reject","record","result","_typeof","__await","then","unwrapped","error","previousPromise","callInvokeWithMethodAndArg","state","Error","doneResult","delegate","delegateResult","maybeInvokeDelegate","sent","_sent","dispatchException","abrupt","done","methodName","undefined","TypeError","info","resultName","next","nextLoc","pushTryEntry","locs","entry","tryLoc","catchLoc","finallyLoc","afterLoc","tryEntries","push","resetTryEntry","completion","reset","iterable","iteratorMethod","isNaN","length","i","displayName","isGeneratorFunction","genFun","ctor","constructor","name","mark","setPrototypeOf","__proto__","awrap","async","Promise","iter","keys","val","object","reverse","pop","skipTempReset","prev","charAt","slice","stop","rootRecord","rval","exception","handle","loc","caught","hasCatch","hasFinally","finallyEntry","complete","finish","_catch","thrown","delegateYield","ownKeys","enumerableOnly","getOwnPropertySymbols","symbols","filter","sym","getOwnPropertyDescriptor","apply","_objectSpread","target","arguments","source","_defineProperty","getOwnPropertyDescriptors","defineProperties","_toPropertyKey","_toPrimitive","String","input","hint","prim","toPrimitive","res","Number","asyncGeneratorStep","gen","_next","_throw","_asyncToGenerator","args","mergeAttributes","Image","Plugin","getDictionary","fileNameToTitle","createNodeView","UploadDialog","createImageUploadDialog","editor","_ref","uploadDialogSelector","i18nUpload","document","querySelector","i18n","onOpen","commands","toggleDialog","onClose","chain","focus","scrollIntoView","run","uploadImage","_ref2","_callee","image","uploadUrl","token","data","_callee$","_context","getAttribute","FormData","append","fetch","mode","cache","headers","body","response","ok","json","responseResolve","message","uploadError","title","_x","_x2","filterImages","files","contentTypes","Array","from","file","RegExp","test","includes","extend","addOptions","_this$parent","parent","uploadImagesPath","addAttributes","_this$parent2","width","addCommands","_this$parent3","_this","uploadDialog","options","imageDialog","_ref4","_callee3","_ref3","dispatch","_this$editor$getAttri","src","alt","dialogState","_callee3$","_context3","getAttributes","toggle","inputLabel","altLabel","uploadHandler","_uploadHandler","_callee2","_callee2$","_context2","_x4","getValue","setImage","_x3","addNodeView","parseHTML","tag","renderHTML","_ref5","HTMLAttributes","addProseMirrorPlugins","_this$options","handleUploadedImages","uploadedImages","imageData","url","props","handlePaste","view","event","items","clipboardData","originalEvent","images","all","map","item","getAsFile","handleDoubleClick","isActive","handleDOMEvents","drop","_event$dataTransfer","position","posAtCoords","left","clientX","top","clientY","dataTransfer","preventDefault","setTextSelection","pos"],"sources":["/home/daniele/decidim_idra-main/app/packs/src/decidim/editor/extensions/image/index.js"],"sourcesContent":["import { mergeAttributes } from \"@tiptap/core\";\nimport Image from \"@tiptap/extension-image\";\nimport { Plugin } from \"prosemirror-state\";\n\nimport { getDictionary } from \"src/decidim/i18n\";\nimport { fileNameToTitle } from \"src/decidim/editor/utilities/file\";\nimport createNodeView from \"src/decidim/editor/extensions/image/node_view\";\n\nimport UploadDialog from \"src/decidim/editor/common/upload_dialog\";\n\nconst createImageUploadDialog = (editor, { uploadDialogSelector }) => {\n  const i18nUpload = getDictionary(\"editor.upload\");\n  return new UploadDialog(\n    document.querySelector(uploadDialogSelector),\n    {\n      i18n: i18nUpload,\n      onOpen: () => editor.commands.toggleDialog(true),\n      onClose: () => editor.chain().toggleDialog(false).focus(null, { scrollIntoView: false }).run()\n    }\n  );\n}\n\nconst uploadImage = async (image, uploadUrl) => {\n  const token = document.querySelector(\"meta[name='csrf-token']\").getAttribute(\"content\");\n\n  const data = new FormData();\n  data.append(\"image\", image);\n\n  const i18n = getDictionary(\"editor.extensions.image\");\n\n  return new Promise((resolve, reject) => {\n    fetch(uploadUrl, {\n      method: \"POST\",\n      mode: \"cors\",\n      cache: \"no-cache\",\n      headers: { \"X-CSRF-Token\": token },\n      body: data\n    }).then((response) => {\n      if (response.ok) {\n        return response.json();\n      }\n      return new Promise((responseResolve) => responseResolve({ message: i18n.uploadError }));\n    }).then(\n      (json) => resolve({ title: fileNameToTitle(image.name), ...json })\n    ).catch(reject);\n  });\n}\n\nconst filterImages = (files, contentTypes) => {\n  return Array.from(files).filter(\n    (file) => {\n      if (contentTypes instanceof RegExp) {\n        return contentTypes.test(file.type)\n      } else if (contentTypes instanceof Array) {\n        return contentTypes.includes(file.type);\n      }\n      // string\n      return contentTypes === file.type;\n    }\n  );\n}\n\n/**\n * Handles the image uploads through ActiveStorage when they are dropped or\n * pasted to the editor.\n *\n * Paste and drop handling based on:\n * https://gist.github.com/slava-vishnyakov/16076dff1a77ddaca93c4bccd4ec4521\n */\nexport default Image.extend({\n  addOptions() {\n    return {\n      ...this.parent?.(),\n      contentTypes: /^image\\/(jpe?g|png|svg|webp)$/i,\n      uploadImagesPath: null,\n      uploadDialogSelector: null\n    };\n  },\n\n  addAttributes() {\n    return {\n      ...this.parent?.(),\n      width: { default: null }\n    };\n  },\n\n  addCommands() {\n    const i18n = getDictionary(\"editor.extensions.image\");\n    const uploadDialog = createImageUploadDialog(this.editor, this.options);\n\n    return {\n      ...this.parent?.(),\n      imageDialog: () => async ({ dispatch }) => {\n        if (dispatch) {\n          let { src, alt, width } = this.editor.getAttributes(\"image\");\n\n          this.editor.commands.toggleDialog(true);\n          const dialogState = await uploadDialog.toggle({ src, alt }, {\n            inputLabel: i18n.altLabel,\n            uploadHandler: async (file) => uploadImage(file, this.options.uploadImagesPath)\n          });\n          this.editor.commands.toggleDialog(false);\n\n          if (dialogState !== \"save\") {\n            this.editor.commands.focus(null, { scrollIntoView: false });\n            return false;\n          }\n\n          if (uploadDialog.getValue(\"src\") !== src) {\n            // Reset the width to original width in case the image changed.\n            width = null;\n          }\n\n          src = uploadDialog.getValue(\"src\");\n          alt = uploadDialog.getValue(\"alt\");\n\n          return this.editor.chain().setImage({ src, alt, width }).focus(null, { scrollIntoView: false }).run();\n        }\n\n        return true;\n      }\n    }\n  },\n\n  addNodeView() {\n    return createNodeView(this);\n  },\n\n  parseHTML() {\n    return [{ tag: \"div[data-image] img[src]:not([src^='data:'])\" }];\n  },\n\n  renderHTML({ HTMLAttributes }) {\n    return [\n      \"div\",\n      { \"class\": \"editor-content-image\", \"data-image\": \"\" },\n      [\n        \"img\",\n        mergeAttributes(this.options.HTMLAttributes, HTMLAttributes)\n      ]\n    ];\n  },\n\n  addProseMirrorPlugins() {\n    const editor = this.editor;\n    const { uploadImagesPath, contentTypes } = this.options;\n\n    const handleUploadedImages = (uploadedImages) => {\n      uploadedImages.forEach((imageData) => {\n        if (!imageData.url) {\n          return;\n        }\n\n        editor.commands.setImage({ src: imageData.url, alt: imageData.title });\n      });\n    }\n\n    return [\n      new Plugin({\n        props: {\n          handlePaste(view, event) {\n            const items = (event.clipboardData || event.originalEvent.clipboardData).items;\n            const images = filterImages(items, contentTypes);\n            if (images.length < 1) {\n              return false;\n            }\n\n            Promise.all(images.map((item) => uploadImage(item.getAsFile(), uploadImagesPath))).then((uploadedImages) => {\n              handleUploadedImages(uploadedImages);\n            });\n\n            return true;\n          },\n\n          handleDoubleClick() {\n            if (!editor.isActive(\"image\")) {\n              return false;\n            }\n\n            editor.chain().focus().imageDialog().run();\n            return true;\n          },\n\n          handleDOMEvents: {\n            drop(view, event) {\n              const position = view.posAtCoords({left: event.clientX, top: event.clientY});\n\n              const files = event?.dataTransfer?.files;\n              if (!files || files.length < 1) {\n                return;\n              }\n\n              const images = filterImages(files, contentTypes);\n              if (images.length < 1) {\n                return;\n              }\n\n              event.preventDefault();\n\n              // Make sure the image is dropped at the right place. Otherwise\n              // the image would appear at the current text selection position\n              // and always in the beginning of the content in case the editor\n              // did not have focus when the image was dropped.\n              editor.chain().focus().setTextSelection(position.pos).run();\n\n              Promise.all(images.map((image) => uploadImage(image, uploadImagesPath))).then((uploadedImages) => {\n                handleUploadedImages(uploadedImages);\n              });\n            }\n          }\n        }\n      })\n    ];\n  }\n});\n"],"mappings":";;;;;;;;;;;;EACA;EAAAA,mBAAA,YAAAA,oBAAA;IAAA,OAAAC,OAAA;EAAA;EAAA,IAAAA,OAAA;IAAAC,EAAA,GAAAC,MAAA,CAAAC,SAAA;IAAAC,MAAA,GAAAH,EAAA,CAAAI,cAAA;IAAAC,cAAA,GAAAJ,MAAA,CAAAI,cAAA,cAAAC,GAAA,EAAAC,GAAA,EAAAC,IAAA;MAAAF,GAAA,CAAAC,GAAA,IAAAC,IAAA,CAAAC,KAAA;IAAA;IAAAC,OAAA,wBAAAC,MAAA,GAAAA,MAAA;IAAAC,cAAA,GAAAF,OAAA,CAAAG,QAAA;IAAAC,mBAAA,GAAAJ,OAAA,CAAAK,aAAA;IAAAC,iBAAA,GAAAN,OAAA,CAAAO,WAAA;EAAA,SAAAC,OAAAZ,GAAA,EAAAC,GAAA,EAAAE,KAAA;IAAA,OAAAR,MAAA,CAAAI,cAAA,CAAAC,GAAA,EAAAC,GAAA;MAAAE,KAAA,EAAAA,KAAA;MAAAU,UAAA;MAAAC,YAAA;MAAAC,QAAA;IAAA,IAAAf,GAAA,CAAAC,GAAA;EAAA;EAAA;IAAAW,MAAA;EAAA,SAAAI,GAAA;IAAAJ,MAAA,YAAAA,OAAAZ,GAAA,EAAAC,GAAA,EAAAE,KAAA;MAAA,OAAAH,GAAA,CAAAC,GAAA,IAAAE,KAAA;IAAA;EAAA;EAAA,SAAAc,KAAAC,OAAA,EAAAC,OAAA,EAAAC,IAAA,EAAAC,WAAA;IAAA,IAAAC,cAAA,GAAAH,OAAA,IAAAA,OAAA,CAAAvB,SAAA,YAAA2B,SAAA,GAAAJ,OAAA,GAAAI,SAAA;MAAAC,SAAA,GAAA7B,MAAA,CAAA8B,MAAA,CAAAH,cAAA,CAAA1B,SAAA;MAAA8B,OAAA,OAAAC,OAAA,CAAAN,WAAA;IAAA,OAAAtB,cAAA,CAAAyB,SAAA;MAAArB,KAAA,EAAAyB,gBAAA,CAAAV,OAAA,EAAAE,IAAA,EAAAM,OAAA;IAAA,IAAAF,SAAA;EAAA;EAAA,SAAAK,SAAAC,EAAA,EAAA9B,GAAA,EAAA+B,GAAA;IAAA;MAAA;QAAAC,IAAA;QAAAD,GAAA,EAAAD,EAAA,CAAAG,IAAA,CAAAjC,GAAA,EAAA+B,GAAA;MAAA;IAAA,SAAAf,GAAA;MAAA;QAAAgB,IAAA;QAAAD,GAAA,EAAAf;MAAA;IAAA;EAAA;EAAAvB,OAAA,CAAAwB,IAAA,GAAAA,IAAA;EAAA,IAAAiB,gBAAA;EAAA,SAAAX,UAAA;EAAA,SAAAY,kBAAA;EAAA,SAAAC,2BAAA;EAAA,IAAAC,iBAAA;EAAAzB,MAAA,CAAAyB,iBAAA,EAAA/B,cAAA;IAAA;EAAA;EAAA,IAAAgC,QAAA,GAAA3C,MAAA,CAAA4C,cAAA;IAAAC,uBAAA,GAAAF,QAAA,IAAAA,QAAA,CAAAA,QAAA,CAAAG,MAAA;EAAAD,uBAAA,IAAAA,uBAAA,KAAA9C,EAAA,IAAAG,MAAA,CAAAoC,IAAA,CAAAO,uBAAA,EAAAlC,cAAA,MAAA+B,iBAAA,GAAAG,uBAAA;EAAA,IAAAE,EAAA,GAAAN,0BAAA,CAAAxC,SAAA,GAAA2B,SAAA,CAAA3B,SAAA,GAAAD,MAAA,CAAA8B,MAAA,CAAAY,iBAAA;EAAA,SAAAM,sBAAA/C,SAAA;IAAA,4BAAAgD,OAAA,WAAAC,MAAA;MAAAjC,MAAA,CAAAhB,SAAA,EAAAiD,MAAA,YAAAd,GAAA;QAAA,YAAAe,OAAA,CAAAD,MAAA,EAAAd,GAAA;MAAA;IAAA;EAAA;EAAA,SAAAgB,cAAAvB,SAAA,EAAAwB,WAAA;IAAA,SAAAC,OAAAJ,MAAA,EAAAd,GAAA,EAAAmB,OAAA,EAAAC,MAAA;MAAA,IAAAC,MAAA,GAAAvB,QAAA,CAAAL,SAAA,CAAAqB,MAAA,GAAArB,SAAA,EAAAO,GAAA;MAAA,gBAAAqB,MAAA,CAAApB,IAAA;QAAA,IAAAqB,MAAA,GAAAD,MAAA,CAAArB,GAAA;UAAA5B,KAAA,GAAAkD,MAAA,CAAAlD,KAAA;QAAA,OAAAA,KAAA,gBAAAmD,OAAA,CAAAnD,KAAA,KAAAN,MAAA,CAAAoC,IAAA,CAAA9B,KAAA,eAAA6C,WAAA,CAAAE,OAAA,CAAA/C,KAAA,CAAAoD,OAAA,EAAAC,IAAA,WAAArD,KAAA;UAAA8C,MAAA,SAAA9C,KAAA,EAAA+C,OAAA,EAAAC,MAAA;QAAA,aAAAnC,GAAA;UAAAiC,MAAA,UAAAjC,GAAA,EAAAkC,OAAA,EAAAC,MAAA;QAAA,KAAAH,WAAA,CAAAE,OAAA,CAAA/C,KAAA,EAAAqD,IAAA,WAAAC,SAAA;UAAAJ,MAAA,CAAAlD,KAAA,GAAAsD,SAAA,EAAAP,OAAA,CAAAG,MAAA;QAAA,aAAAK,KAAA;UAAA,OAAAT,MAAA,UAAAS,KAAA,EAAAR,OAAA,EAAAC,MAAA;QAAA;MAAA;MAAAA,MAAA,CAAAC,MAAA,CAAArB,GAAA;IAAA;IAAA,IAAA4B,eAAA;IAAA5D,cAAA;MAAAI,KAAA,WAAAA,MAAA0C,MAAA,EAAAd,GAAA;QAAA,SAAA6B,2BAAA;UAAA,WAAAZ,WAAA,WAAAE,OAAA,EAAAC,MAAA;YAAAF,MAAA,CAAAJ,MAAA,EAAAd,GAAA,EAAAmB,OAAA,EAAAC,MAAA;UAAA;QAAA;QAAA,OAAAQ,eAAA,GAAAA,eAAA,GAAAA,eAAA,CAAAH,IAAA,CAAAI,0BAAA,EAAAA,0BAAA,IAAAA,0BAAA;MAAA;IAAA;EAAA;EAAA,SAAAhC,iBAAAV,OAAA,EAAAE,IAAA,EAAAM,OAAA;IAAA,IAAAmC,KAAA;IAAA,iBAAAhB,MAAA,EAAAd,GAAA;MAAA,oBAAA8B,KAAA,YAAAC,KAAA;MAAA,oBAAAD,KAAA;QAAA,gBAAAhB,MAAA,QAAAd,GAAA;QAAA,OAAAgC,UAAA;MAAA;MAAA,KAAArC,OAAA,CAAAmB,MAAA,GAAAA,MAAA,EAAAnB,OAAA,CAAAK,GAAA,GAAAA,GAAA;QAAA,IAAAiC,QAAA,GAAAtC,OAAA,CAAAsC,QAAA;QAAA,IAAAA,QAAA;UAAA,IAAAC,cAAA,GAAAC,mBAAA,CAAAF,QAAA,EAAAtC,OAAA;UAAA,IAAAuC,cAAA;YAAA,IAAAA,cAAA,KAAA/B,gBAAA;YAAA,OAAA+B,cAAA;UAAA;QAAA;QAAA,eAAAvC,OAAA,CAAAmB,MAAA,EAAAnB,OAAA,CAAAyC,IAAA,GAAAzC,OAAA,CAAA0C,KAAA,GAAA1C,OAAA,CAAAK,GAAA,sBAAAL,OAAA,CAAAmB,MAAA;UAAA,yBAAAgB,KAAA,QAAAA,KAAA,gBAAAnC,OAAA,CAAAK,GAAA;UAAAL,OAAA,CAAA2C,iBAAA,CAAA3C,OAAA,CAAAK,GAAA;QAAA,oBAAAL,OAAA,CAAAmB,MAAA,IAAAnB,OAAA,CAAA4C,MAAA,WAAA5C,OAAA,CAAAK,GAAA;QAAA8B,KAAA;QAAA,IAAAT,MAAA,GAAAvB,QAAA,CAAAX,OAAA,EAAAE,IAAA,EAAAM,OAAA;QAAA,iBAAA0B,MAAA,CAAApB,IAAA;UAAA,IAAA6B,KAAA,GAAAnC,OAAA,CAAA6C,IAAA,mCAAAnB,MAAA,CAAArB,GAAA,KAAAG,gBAAA;UAAA;YAAA/B,KAAA,EAAAiD,MAAA,CAAArB,GAAA;YAAAwC,IAAA,EAAA7C,OAAA,CAAA6C;UAAA;QAAA;QAAA,YAAAnB,MAAA,CAAApB,IAAA,KAAA6B,KAAA,gBAAAnC,OAAA,CAAAmB,MAAA,YAAAnB,OAAA,CAAAK,GAAA,GAAAqB,MAAA,CAAArB,GAAA;MAAA;IAAA;EAAA;EAAA,SAAAmC,oBAAAF,QAAA,EAAAtC,OAAA;IAAA,IAAA8C,UAAA,GAAA9C,OAAA,CAAAmB,MAAA;MAAAA,MAAA,GAAAmB,QAAA,CAAAzD,QAAA,CAAAiE,UAAA;IAAA,IAAAC,SAAA,KAAA5B,MAAA,SAAAnB,OAAA,CAAAsC,QAAA,qBAAAQ,UAAA,IAAAR,QAAA,CAAAzD,QAAA,eAAAmB,OAAA,CAAAmB,MAAA,aAAAnB,OAAA,CAAAK,GAAA,GAAA0C,SAAA,EAAAP,mBAAA,CAAAF,QAAA,EAAAtC,OAAA,eAAAA,OAAA,CAAAmB,MAAA,kBAAA2B,UAAA,KAAA9C,OAAA,CAAAmB,MAAA,YAAAnB,OAAA,CAAAK,GAAA,OAAA2C,SAAA,uCAAAF,UAAA,iBAAAtC,gBAAA;IAAA,IAAAkB,MAAA,GAAAvB,QAAA,CAAAgB,MAAA,EAAAmB,QAAA,CAAAzD,QAAA,EAAAmB,OAAA,CAAAK,GAAA;IAAA,gBAAAqB,MAAA,CAAApB,IAAA,SAAAN,OAAA,CAAAmB,MAAA,YAAAnB,OAAA,CAAAK,GAAA,GAAAqB,MAAA,CAAArB,GAAA,EAAAL,OAAA,CAAAsC,QAAA,SAAA9B,gBAAA;IAAA,IAAAyC,IAAA,GAAAvB,MAAA,CAAArB,GAAA;IAAA,OAAA4C,IAAA,GAAAA,IAAA,CAAAJ,IAAA,IAAA7C,OAAA,CAAAsC,QAAA,CAAAY,UAAA,IAAAD,IAAA,CAAAxE,KAAA,EAAAuB,OAAA,CAAAmD,IAAA,GAAAb,QAAA,CAAAc,OAAA,eAAApD,OAAA,CAAAmB,MAAA,KAAAnB,OAAA,CAAAmB,MAAA,WAAAnB,OAAA,CAAAK,GAAA,GAAA0C,SAAA,GAAA/C,OAAA,CAAAsC,QAAA,SAAA9B,gBAAA,IAAAyC,IAAA,IAAAjD,OAAA,CAAAmB,MAAA,YAAAnB,OAAA,CAAAK,GAAA,OAAA2C,SAAA,sCAAAhD,OAAA,CAAAsC,QAAA,SAAA9B,gBAAA;EAAA;EAAA,SAAA6C,aAAAC,IAAA;IAAA,IAAAC,KAAA;MAAAC,MAAA,EAAAF,IAAA;IAAA;IAAA,KAAAA,IAAA,KAAAC,KAAA,CAAAE,QAAA,GAAAH,IAAA,WAAAA,IAAA,KAAAC,KAAA,CAAAG,UAAA,GAAAJ,IAAA,KAAAC,KAAA,CAAAI,QAAA,GAAAL,IAAA,WAAAM,UAAA,CAAAC,IAAA,CAAAN,KAAA;EAAA;EAAA,SAAAO,cAAAP,KAAA;IAAA,IAAA7B,MAAA,GAAA6B,KAAA,CAAAQ,UAAA;IAAArC,MAAA,CAAApB,IAAA,oBAAAoB,MAAA,CAAArB,GAAA,EAAAkD,KAAA,CAAAQ,UAAA,GAAArC,MAAA;EAAA;EAAA,SAAAzB,QAAAN,WAAA;IAAA,KAAAiE,UAAA;MAAAJ,MAAA;IAAA,IAAA7D,WAAA,CAAAuB,OAAA,CAAAmC,YAAA,cAAAW,KAAA;EAAA;EAAA,SAAAjD,OAAAkD,QAAA;IAAA,IAAAA,QAAA;MAAA,IAAAC,cAAA,GAAAD,QAAA,CAAArF,cAAA;MAAA,IAAAsF,cAAA,SAAAA,cAAA,CAAA3D,IAAA,CAAA0D,QAAA;MAAA,yBAAAA,QAAA,CAAAd,IAAA,SAAAc,QAAA;MAAA,KAAAE,KAAA,CAAAF,QAAA,CAAAG,MAAA;QAAA,IAAAC,CAAA;UAAAlB,IAAA,YAAAA,KAAA;YAAA,SAAAkB,CAAA,GAAAJ,QAAA,CAAAG,MAAA,OAAAjG,MAAA,CAAAoC,IAAA,CAAA0D,QAAA,EAAAI,CAAA,UAAAlB,IAAA,CAAA1E,KAAA,GAAAwF,QAAA,CAAAI,CAAA,GAAAlB,IAAA,CAAAN,IAAA,OAAAM,IAAA;YAAA,OAAAA,IAAA,CAAA1E,KAAA,GAAAsE,SAAA,EAAAI,IAAA,CAAAN,IAAA,OAAAM,IAAA;UAAA;QAAA,OAAAA,IAAA,CAAAA,IAAA,GAAAA,IAAA;MAAA;IAAA;IAAA;MAAAA,IAAA,EAAAd;IAAA;EAAA;EAAA,SAAAA,WAAA;IAAA;MAAA5D,KAAA,EAAAsE,SAAA;MAAAF,IAAA;IAAA;EAAA;EAAA,OAAApC,iBAAA,CAAAvC,SAAA,GAAAwC,0BAAA,EAAArC,cAAA,CAAA2C,EAAA;IAAAvC,KAAA,EAAAiC,0BAAA;IAAAtB,YAAA;EAAA,IAAAf,cAAA,CAAAqC,0BAAA;IAAAjC,KAAA,EAAAgC,iBAAA;IAAArB,YAAA;EAAA,IAAAqB,iBAAA,CAAA6D,WAAA,GAAApF,MAAA,CAAAwB,0BAAA,EAAA1B,iBAAA,wBAAAjB,OAAA,CAAAwG,mBAAA,aAAAC,MAAA;IAAA,IAAAC,IAAA,wBAAAD,MAAA,IAAAA,MAAA,CAAAE,WAAA;IAAA,SAAAD,IAAA,KAAAA,IAAA,KAAAhE,iBAAA,6BAAAgE,IAAA,CAAAH,WAAA,IAAAG,IAAA,CAAAE,IAAA;EAAA,GAAA5G,OAAA,CAAA6G,IAAA,aAAAJ,MAAA;IAAA,OAAAvG,MAAA,CAAA4G,cAAA,GAAA5G,MAAA,CAAA4G,cAAA,CAAAL,MAAA,EAAA9D,0BAAA,KAAA8D,MAAA,CAAAM,SAAA,GAAApE,0BAAA,EAAAxB,MAAA,CAAAsF,MAAA,EAAAxF,iBAAA,yBAAAwF,MAAA,CAAAtG,SAAA,GAAAD,MAAA,CAAA8B,MAAA,CAAAiB,EAAA,GAAAwD,MAAA;EAAA,GAAAzG,OAAA,CAAAgH,KAAA,aAAA1E,GAAA;IAAA;MAAAwB,OAAA,EAAAxB;IAAA;EAAA,GAAAY,qBAAA,CAAAI,aAAA,CAAAnD,SAAA,GAAAgB,MAAA,CAAAmC,aAAA,CAAAnD,SAAA,EAAAY,mBAAA;IAAA;EAAA,IAAAf,OAAA,CAAAsD,aAAA,GAAAA,aAAA,EAAAtD,OAAA,CAAAiH,KAAA,aAAAxF,OAAA,EAAAC,OAAA,EAAAC,IAAA,EAAAC,WAAA,EAAA2B,WAAA;IAAA,WAAAA,WAAA,KAAAA,WAAA,GAAA2D,OAAA;IAAA,IAAAC,IAAA,OAAA7D,aAAA,CAAA9B,IAAA,CAAAC,OAAA,EAAAC,OAAA,EAAAC,IAAA,EAAAC,WAAA,GAAA2B,WAAA;IAAA,OAAAvD,OAAA,CAAAwG,mBAAA,CAAA9E,OAAA,IAAAyF,IAAA,GAAAA,IAAA,CAAA/B,IAAA,GAAArB,IAAA,WAAAH,MAAA;MAAA,OAAAA,MAAA,CAAAkB,IAAA,GAAAlB,MAAA,CAAAlD,KAAA,GAAAyG,IAAA,CAAA/B,IAAA;IAAA;EAAA,GAAAlC,qBAAA,CAAAD,EAAA,GAAA9B,MAAA,CAAA8B,EAAA,EAAAhC,iBAAA,gBAAAE,MAAA,CAAA8B,EAAA,EAAApC,cAAA;IAAA;EAAA,IAAAM,MAAA,CAAA8B,EAAA;IAAA;EAAA,IAAAjD,OAAA,CAAAoH,IAAA,aAAAC,GAAA;IAAA,IAAAC,MAAA,GAAApH,MAAA,CAAAmH,GAAA;MAAAD,IAAA;IAAA,SAAA5G,GAAA,IAAA8G,MAAA,EAAAF,IAAA,CAAAtB,IAAA,CAAAtF,GAAA;IAAA,OAAA4G,IAAA,CAAAG,OAAA,aAAAnC,KAAA;MAAA,OAAAgC,IAAA,CAAAf,MAAA;QAAA,IAAA7F,GAAA,GAAA4G,IAAA,CAAAI,GAAA;QAAA,IAAAhH,GAAA,IAAA8G,MAAA,SAAAlC,IAAA,CAAA1E,KAAA,GAAAF,GAAA,EAAA4E,IAAA,CAAAN,IAAA,OAAAM,IAAA;MAAA;MAAA,OAAAA,IAAA,CAAAN,IAAA,OAAAM,IAAA;IAAA;EAAA,GAAApF,OAAA,CAAAgD,MAAA,GAAAA,MAAA,EAAAd,OAAA,CAAA/B,SAAA;IAAAwG,WAAA,EAAAzE,OAAA;IAAA+D,KAAA,WAAAA,MAAAwB,aAAA;MAAA,SAAAC,IAAA,WAAAtC,IAAA,WAAAV,IAAA,QAAAC,KAAA,GAAAK,SAAA,OAAAF,IAAA,YAAAP,QAAA,cAAAnB,MAAA,gBAAAd,GAAA,GAAA0C,SAAA,OAAAa,UAAA,CAAA1C,OAAA,CAAA4C,aAAA,IAAA0B,aAAA,WAAAb,IAAA,kBAAAA,IAAA,CAAAe,MAAA,OAAAvH,MAAA,CAAAoC,IAAA,OAAAoE,IAAA,MAAAR,KAAA,EAAAQ,IAAA,CAAAgB,KAAA,cAAAhB,IAAA,IAAA5B,SAAA;IAAA;IAAA6C,IAAA,WAAAA,KAAA;MAAA,KAAA/C,IAAA;MAAA,IAAAgD,UAAA,QAAAjC,UAAA,IAAAG,UAAA;MAAA,gBAAA8B,UAAA,CAAAvF,IAAA,QAAAuF,UAAA,CAAAxF,GAAA;MAAA,YAAAyF,IAAA;IAAA;IAAAnD,iBAAA,WAAAA,kBAAAoD,SAAA;MAAA,SAAAlD,IAAA,QAAAkD,SAAA;MAAA,IAAA/F,OAAA;MAAA,SAAAgG,OAAAC,GAAA,EAAAC,MAAA;QAAA,OAAAxE,MAAA,CAAApB,IAAA,YAAAoB,MAAA,CAAArB,GAAA,GAAA0F,SAAA,EAAA/F,OAAA,CAAAmD,IAAA,GAAA8C,GAAA,EAAAC,MAAA,KAAAlG,OAAA,CAAAmB,MAAA,WAAAnB,OAAA,CAAAK,GAAA,GAAA0C,SAAA,KAAAmD,MAAA;MAAA;MAAA,SAAA7B,CAAA,QAAAT,UAAA,CAAAQ,MAAA,MAAAC,CAAA,SAAAA,CAAA;QAAA,IAAAd,KAAA,QAAAK,UAAA,CAAAS,CAAA;UAAA3C,MAAA,GAAA6B,KAAA,CAAAQ,UAAA;QAAA,eAAAR,KAAA,CAAAC,MAAA,SAAAwC,MAAA;QAAA,IAAAzC,KAAA,CAAAC,MAAA,SAAAiC,IAAA;UAAA,IAAAU,QAAA,GAAAhI,MAAA,CAAAoC,IAAA,CAAAgD,KAAA;YAAA6C,UAAA,GAAAjI,MAAA,CAAAoC,IAAA,CAAAgD,KAAA;UAAA,IAAA4C,QAAA,IAAAC,UAAA;YAAA,SAAAX,IAAA,GAAAlC,KAAA,CAAAE,QAAA,SAAAuC,MAAA,CAAAzC,KAAA,CAAAE,QAAA;YAAA,SAAAgC,IAAA,GAAAlC,KAAA,CAAAG,UAAA,SAAAsC,MAAA,CAAAzC,KAAA,CAAAG,UAAA;UAAA,WAAAyC,QAAA;YAAA,SAAAV,IAAA,GAAAlC,KAAA,CAAAE,QAAA,SAAAuC,MAAA,CAAAzC,KAAA,CAAAE,QAAA;UAAA;YAAA,KAAA2C,UAAA,YAAAhE,KAAA;YAAA,SAAAqD,IAAA,GAAAlC,KAAA,CAAAG,UAAA,SAAAsC,MAAA,CAAAzC,KAAA,CAAAG,UAAA;UAAA;QAAA;MAAA;IAAA;IAAAd,MAAA,WAAAA,OAAAtC,IAAA,EAAAD,GAAA;MAAA,SAAAgE,CAAA,QAAAT,UAAA,CAAAQ,MAAA,MAAAC,CAAA,SAAAA,CAAA;QAAA,IAAAd,KAAA,QAAAK,UAAA,CAAAS,CAAA;QAAA,IAAAd,KAAA,CAAAC,MAAA,SAAAiC,IAAA,IAAAtH,MAAA,CAAAoC,IAAA,CAAAgD,KAAA,wBAAAkC,IAAA,GAAAlC,KAAA,CAAAG,UAAA;UAAA,IAAA2C,YAAA,GAAA9C,KAAA;UAAA;QAAA;MAAA;MAAA8C,YAAA,iBAAA/F,IAAA,mBAAAA,IAAA,KAAA+F,YAAA,CAAA7C,MAAA,IAAAnD,GAAA,IAAAA,GAAA,IAAAgG,YAAA,CAAA3C,UAAA,KAAA2C,YAAA;MAAA,IAAA3E,MAAA,GAAA2E,YAAA,GAAAA,YAAA,CAAAtC,UAAA;MAAA,OAAArC,MAAA,CAAApB,IAAA,GAAAA,IAAA,EAAAoB,MAAA,CAAArB,GAAA,GAAAA,GAAA,EAAAgG,YAAA,SAAAlF,MAAA,gBAAAgC,IAAA,GAAAkD,YAAA,CAAA3C,UAAA,EAAAlD,gBAAA,SAAA8F,QAAA,CAAA5E,MAAA;IAAA;IAAA4E,QAAA,WAAAA,SAAA5E,MAAA,EAAAiC,QAAA;MAAA,gBAAAjC,MAAA,CAAApB,IAAA,QAAAoB,MAAA,CAAArB,GAAA;MAAA,mBAAAqB,MAAA,CAAApB,IAAA,mBAAAoB,MAAA,CAAApB,IAAA,QAAA6C,IAAA,GAAAzB,MAAA,CAAArB,GAAA,gBAAAqB,MAAA,CAAApB,IAAA,SAAAwF,IAAA,QAAAzF,GAAA,GAAAqB,MAAA,CAAArB,GAAA,OAAAc,MAAA,kBAAAgC,IAAA,yBAAAzB,MAAA,CAAApB,IAAA,IAAAqD,QAAA,UAAAR,IAAA,GAAAQ,QAAA,GAAAnD,gBAAA;IAAA;IAAA+F,MAAA,WAAAA,OAAA7C,UAAA;MAAA,SAAAW,CAAA,QAAAT,UAAA,CAAAQ,MAAA,MAAAC,CAAA,SAAAA,CAAA;QAAA,IAAAd,KAAA,QAAAK,UAAA,CAAAS,CAAA;QAAA,IAAAd,KAAA,CAAAG,UAAA,KAAAA,UAAA,cAAA4C,QAAA,CAAA/C,KAAA,CAAAQ,UAAA,EAAAR,KAAA,CAAAI,QAAA,GAAAG,aAAA,CAAAP,KAAA,GAAA/C,gBAAA;MAAA;IAAA;IAAA,kBAAAgG,OAAAhD,MAAA;MAAA,SAAAa,CAAA,QAAAT,UAAA,CAAAQ,MAAA,MAAAC,CAAA,SAAAA,CAAA;QAAA,IAAAd,KAAA,QAAAK,UAAA,CAAAS,CAAA;QAAA,IAAAd,KAAA,CAAAC,MAAA,KAAAA,MAAA;UAAA,IAAA9B,MAAA,GAAA6B,KAAA,CAAAQ,UAAA;UAAA,gBAAArC,MAAA,CAAApB,IAAA;YAAA,IAAAmG,MAAA,GAAA/E,MAAA,CAAArB,GAAA;YAAAyD,aAAA,CAAAP,KAAA;UAAA;UAAA,OAAAkD,MAAA;QAAA;MAAA;MAAA,UAAArE,KAAA;IAAA;IAAAsE,aAAA,WAAAA,cAAAzC,QAAA,EAAAf,UAAA,EAAAE,OAAA;MAAA,YAAAd,QAAA;QAAAzD,QAAA,EAAAkC,MAAA,CAAAkD,QAAA;QAAAf,UAAA,EAAAA,UAAA;QAAAE,OAAA,EAAAA;MAAA,mBAAAjC,MAAA,UAAAd,GAAA,GAAA0C,SAAA,GAAAvC,gBAAA;IAAA;EAAA,GAAAzC,OAAA;AAAA;AAAA,SAAA4I,QAAAtB,MAAA,EAAAuB,cAAA;EAAA,IAAAzB,IAAA,GAAAlH,MAAA,CAAAkH,IAAA,CAAAE,MAAA;EAAA,IAAApH,MAAA,CAAA4I,qBAAA;IAAA,IAAAC,OAAA,GAAA7I,MAAA,CAAA4I,qBAAA,CAAAxB,MAAA;IAAAuB,cAAA,KAAAE,OAAA,GAAAA,OAAA,CAAAC,MAAA,WAAAC,GAAA;MAAA,OAAA/I,MAAA,CAAAgJ,wBAAA,CAAA5B,MAAA,EAAA2B,GAAA,EAAA7H,UAAA;IAAA,KAAAgG,IAAA,CAAAtB,IAAA,CAAAqD,KAAA,CAAA/B,IAAA,EAAA2B,OAAA;EAAA;EAAA,OAAA3B,IAAA;AAAA;AAAA,SAAAgC,cAAAC,MAAA;EAAA,SAAA/C,CAAA,MAAAA,CAAA,GAAAgD,SAAA,CAAAjD,MAAA,EAAAC,CAAA;IAAA,IAAAiD,MAAA,WAAAD,SAAA,CAAAhD,CAAA,IAAAgD,SAAA,CAAAhD,CAAA;IAAAA,CAAA,OAAAsC,OAAA,CAAA1I,MAAA,CAAAqJ,MAAA,OAAApG,OAAA,WAAA3C,GAAA;MAAAgJ,eAAA,CAAAH,MAAA,EAAA7I,GAAA,EAAA+I,MAAA,CAAA/I,GAAA;IAAA,KAAAN,MAAA,CAAAuJ,yBAAA,GAAAvJ,MAAA,CAAAwJ,gBAAA,CAAAL,MAAA,EAAAnJ,MAAA,CAAAuJ,yBAAA,CAAAF,MAAA,KAAAX,OAAA,CAAA1I,MAAA,CAAAqJ,MAAA,GAAApG,OAAA,WAAA3C,GAAA;MAAAN,MAAA,CAAAI,cAAA,CAAA+I,MAAA,EAAA7I,GAAA,EAAAN,MAAA,CAAAgJ,wBAAA,CAAAK,MAAA,EAAA/I,GAAA;IAAA;EAAA;EAAA,OAAA6I,MAAA;AAAA;AAAA,SAAAG,gBAAAjJ,GAAA,EAAAC,GAAA,EAAAE,KAAA;EAAAF,GAAA,GAAAmJ,cAAA,CAAAnJ,GAAA;EAAA,IAAAA,GAAA,IAAAD,GAAA;IAAAL,MAAA,CAAAI,cAAA,CAAAC,GAAA,EAAAC,GAAA;MAAAE,KAAA,EAAAA,KAAA;MAAAU,UAAA;MAAAC,YAAA;MAAAC,QAAA;IAAA;EAAA;IAAAf,GAAA,CAAAC,GAAA,IAAAE,KAAA;EAAA;EAAA,OAAAH,GAAA;AAAA;AAAA,SAAAoJ,eAAArH,GAAA;EAAA,IAAA9B,GAAA,GAAAoJ,YAAA,CAAAtH,GAAA;EAAA,OAAAuB,OAAA,CAAArD,GAAA,iBAAAA,GAAA,GAAAqJ,MAAA,CAAArJ,GAAA;AAAA;AAAA,SAAAoJ,aAAAE,KAAA,EAAAC,IAAA;EAAA,IAAAlG,OAAA,CAAAiG,KAAA,kBAAAA,KAAA,kBAAAA,KAAA;EAAA,IAAAE,IAAA,GAAAF,KAAA,CAAAlJ,MAAA,CAAAqJ,WAAA;EAAA,IAAAD,IAAA,KAAAhF,SAAA;IAAA,IAAAkF,GAAA,GAAAF,IAAA,CAAAxH,IAAA,CAAAsH,KAAA,EAAAC,IAAA;IAAA,IAAAlG,OAAA,CAAAqG,GAAA,uBAAAA,GAAA;IAAA,UAAAjF,SAAA;EAAA;EAAA,QAAA8E,IAAA,gBAAAF,MAAA,GAAAM,MAAA,EAAAL,KAAA;AAAA;AAAA,SAAAM,mBAAAC,GAAA,EAAA5G,OAAA,EAAAC,MAAA,EAAA4G,KAAA,EAAAC,MAAA,EAAA/J,GAAA,EAAA8B,GAAA;EAAA;IAAA,IAAA4C,IAAA,GAAAmF,GAAA,CAAA7J,GAAA,EAAA8B,GAAA;IAAA,IAAA5B,KAAA,GAAAwE,IAAA,CAAAxE,KAAA;EAAA,SAAAuD,KAAA;IAAAP,MAAA,CAAAO,KAAA;IAAA;EAAA;EAAA,IAAAiB,IAAA,CAAAJ,IAAA;IAAArB,OAAA,CAAA/C,KAAA;EAAA;IAAAwG,OAAA,CAAAzD,OAAA,CAAA/C,KAAA,EAAAqD,IAAA,CAAAuG,KAAA,EAAAC,MAAA;EAAA;AAAA;AAAA,SAAAC,kBAAAnI,EAAA;EAAA;IAAA,IAAAV,IAAA;MAAA8I,IAAA,GAAAnB,SAAA;IAAA,WAAApC,OAAA,WAAAzD,OAAA,EAAAC,MAAA;MAAA,IAAA2G,GAAA,GAAAhI,EAAA,CAAA8G,KAAA,CAAAxH,IAAA,EAAA8I,IAAA;MAAA,SAAAH,MAAA5J,KAAA;QAAA0J,kBAAA,CAAAC,GAAA,EAAA5G,OAAA,EAAAC,MAAA,EAAA4G,KAAA,EAAAC,MAAA,UAAA7J,KAAA;MAAA;MAAA,SAAA6J,OAAAhJ,GAAA;QAAA6I,kBAAA,CAAAC,GAAA,EAAA5G,OAAA,EAAAC,MAAA,EAAA4G,KAAA,EAAAC,MAAA,WAAAhJ,GAAA;MAAA;MAAA+I,KAAA,CAAAtF,SAAA;IAAA;EAAA;AAAA;AADA,SAAS0F,eAAe,QAAQ,cAAc;AAC9C,OAAOC,KAAK,MAAM,yBAAyB;AAC3C,SAASC,MAAM,QAAQ,mBAAmB;AAE1C,SAASC,aAAa,QAAQ,kBAAkB;AAChD,SAASC,eAAe,QAAQ,mCAAmC;AACnE,OAAOC,cAAc,MAAM,+CAA+C;AAE1E,OAAOC,YAAY,MAAM,yCAAyC;AAElE,IAAMC,uBAAuB,GAAG,SAA1BA,uBAAuBA,CAAIC,MAAM,EAAAC,IAAA,EAA+B;EAAA,IAA3BC,oBAAoB,GAAAD,IAAA,CAApBC,oBAAoB;EAC7D,IAAMC,UAAU,GAAGR,aAAa,CAAC,eAAe,CAAC;EACjD,OAAO,IAAIG,YAAY,CACrBM,QAAQ,CAACC,aAAa,CAACH,oBAAoB,CAAC,EAC5C;IACEI,IAAI,EAAEH,UAAU;IAChBI,MAAM,EAAE,SAAAA,OAAA;MAAA,OAAMP,MAAM,CAACQ,QAAQ,CAACC,YAAY,CAAC,IAAI,CAAC;IAAA;IAChDC,OAAO,EAAE,SAAAA,QAAA;MAAA,OAAMV,MAAM,CAACW,KAAK,EAAE,CAACF,YAAY,CAAC,KAAK,CAAC,CAACG,KAAK,CAAC,IAAI,EAAE;QAAEC,cAAc,EAAE;MAAM,CAAC,CAAC,CAACC,GAAG,EAAE;IAAA;EAChG,CAAC,CACF;AACH,CAAC;AAED,IAAMC,WAAW;EAAA,IAAAC,KAAA,GAAA1B,iBAAA,eAAAzK,mBAAA,GAAA8G,IAAA,CAAG,SAAAsF,QAAOC,KAAK,EAAEC,SAAS;IAAA,IAAAC,KAAA,EAAAC,IAAA,EAAAf,IAAA;IAAA,OAAAzL,mBAAA,GAAAyB,IAAA,UAAAgL,SAAAC,QAAA;MAAA,kBAAAA,QAAA,CAAA/E,IAAA,GAAA+E,QAAA,CAAArH,IAAA;QAAA;UACnCkH,KAAK,GAAGhB,QAAQ,CAACC,aAAa,CAAC,yBAAyB,CAAC,CAACmB,YAAY,CAAC,SAAS,CAAC;UAEjFH,IAAI,GAAG,IAAII,QAAQ,EAAE;UAC3BJ,IAAI,CAACK,MAAM,CAAC,OAAO,EAAER,KAAK,CAAC;UAErBZ,IAAI,GAAGX,aAAa,CAAC,yBAAyB,CAAC;UAAA,OAAA4B,QAAA,CAAA5H,MAAA,WAE9C,IAAIqC,OAAO,CAAC,UAACzD,OAAO,EAAEC,MAAM,EAAK;YACtCmJ,KAAK,CAACR,SAAS,EAAE;cACfjJ,MAAM,EAAE,MAAM;cACd0J,IAAI,EAAE,MAAM;cACZC,KAAK,EAAE,UAAU;cACjBC,OAAO,EAAE;gBAAE,cAAc,EAAEV;cAAM,CAAC;cAClCW,IAAI,EAAEV;YACR,CAAC,CAAC,CAACxI,IAAI,CAAC,UAACmJ,QAAQ,EAAK;cACpB,IAAIA,QAAQ,CAACC,EAAE,EAAE;gBACf,OAAOD,QAAQ,CAACE,IAAI,EAAE;cACxB;cACA,OAAO,IAAIlG,OAAO,CAAC,UAACmG,eAAe;gBAAA,OAAKA,eAAe,CAAC;kBAAEC,OAAO,EAAE9B,IAAI,CAAC+B;gBAAY,CAAC,CAAC;cAAA,EAAC;YACzF,CAAC,CAAC,CAACxJ,IAAI,CACL,UAACqJ,IAAI;cAAA,OAAK3J,OAAO,CAAA2F,aAAA;gBAAGoE,KAAK,EAAE1C,eAAe,CAACsB,KAAK,CAACxF,IAAI;cAAC,GAAKwG,IAAI,EAAG;YAAA,EACnE,SAAM,CAAC1J,MAAM,CAAC;UACjB,CAAC,CAAC;QAAA;QAAA;UAAA,OAAA+I,QAAA,CAAA5E,IAAA;MAAA;IAAA,GAAAsE,OAAA;EAAA,CACH;EAAA,gBAxBKF,WAAWA,CAAAwB,EAAA,EAAAC,GAAA;IAAA,OAAAxB,KAAA,CAAA/C,KAAA,OAAAG,SAAA;EAAA;AAAA,GAwBhB;AAED,IAAMqE,YAAY,GAAG,SAAfA,YAAYA,CAAIC,KAAK,EAAEC,YAAY,EAAK;EAC5C,OAAOC,KAAK,CAACC,IAAI,CAACH,KAAK,CAAC,CAAC5E,MAAM,CAC7B,UAACgF,IAAI,EAAK;IACR,IAAIH,YAAY,YAAYI,MAAM,EAAE;MAClC,OAAOJ,YAAY,CAACK,IAAI,CAACF,IAAI,CAACzL,IAAI,CAAC;IACrC,CAAC,MAAM,IAAIsL,YAAY,YAAYC,KAAK,EAAE;MACxC,OAAOD,YAAY,CAACM,QAAQ,CAACH,IAAI,CAACzL,IAAI,CAAC;IACzC;IACA;IACA,OAAOsL,YAAY,KAAKG,IAAI,CAACzL,IAAI;EACnC,CAAC,CACF;AACH,CAAC;;AAED;AACA;AACA;AACA;AACA;AACA;AACA;AACA,eAAeoI,KAAK,CAACyD,MAAM,CAAC;EAC1BC,UAAU,WAAAA,WAAA,EAAG;IAAA,IAAAC,YAAA;IACX,OAAAlF,aAAA,CAAAA,aAAA,MAAAkF,YAAA,GACK,IAAI,CAACC,MAAM,cAAAD,YAAA,uBAAXA,YAAA,CAAA9L,IAAA,KAAI,CAAW;MAClBqL,YAAY,EAAE,gCAAgC;MAC9CW,gBAAgB,EAAE,IAAI;MACtBpD,oBAAoB,EAAE;IAAI;EAE9B,CAAC;EAEDqD,aAAa,WAAAA,cAAA,EAAG;IAAA,IAAAC,aAAA;IACd,OAAAtF,aAAA,CAAAA,aAAA,MAAAsF,aAAA,GACK,IAAI,CAACH,MAAM,cAAAG,aAAA,uBAAXA,aAAA,CAAAlM,IAAA,KAAI,CAAW;MAClBmM,KAAK,EAAE;QAAE,WAAS;MAAK;IAAC;EAE5B,CAAC;EAEDC,WAAW,WAAAA,YAAA,EAAG;IAAA,IAAAC,aAAA;MAAAC,KAAA;IACZ,IAAMtD,IAAI,GAAGX,aAAa,CAAC,yBAAyB,CAAC;IACrD,IAAMkE,YAAY,GAAG9D,uBAAuB,CAAC,IAAI,CAACC,MAAM,EAAE,IAAI,CAAC8D,OAAO,CAAC;IAEvE,OAAA5F,aAAA,CAAAA,aAAA,MAAAyF,aAAA,GACK,IAAI,CAACN,MAAM,cAAAM,aAAA,uBAAXA,aAAA,CAAArM,IAAA,KAAI,CAAW;MAClByM,WAAW,EAAE,SAAAA,YAAA;QAAA;UAAA,IAAAC,KAAA,GAAA1E,iBAAA,eAAAzK,mBAAA,GAAA8G,IAAA,CAAM,SAAAsI,SAAAC,KAAA;YAAA,IAAAC,QAAA,EAAAC,qBAAA,EAAAC,GAAA,EAAAC,GAAA,EAAAb,KAAA,EAAAc,WAAA;YAAA,OAAA1P,mBAAA,GAAAyB,IAAA,UAAAkO,UAAAC,SAAA;cAAA,kBAAAA,SAAA,CAAAjI,IAAA,GAAAiI,SAAA,CAAAvK,IAAA;gBAAA;kBAASiK,QAAQ,GAAAD,KAAA,CAARC,QAAQ;kBAAA,KAC9BA,QAAQ;oBAAAM,SAAA,CAAAvK,IAAA;oBAAA;kBAAA;kBAAAkK,qBAAA,GACgBR,KAAI,CAAC5D,MAAM,CAAC0E,aAAa,CAAC,OAAO,CAAC,EAAtDL,GAAG,GAAAD,qBAAA,CAAHC,GAAG,EAAEC,GAAG,GAAAF,qBAAA,CAAHE,GAAG,EAAEb,KAAK,GAAAW,qBAAA,CAALX,KAAK;kBAErBG,KAAI,CAAC5D,MAAM,CAACQ,QAAQ,CAACC,YAAY,CAAC,IAAI,CAAC;kBAACgE,SAAA,CAAAvK,IAAA;kBAAA,OACd2J,YAAY,CAACc,MAAM,CAAC;oBAAEN,GAAG,EAAHA,GAAG;oBAAEC,GAAG,EAAHA;kBAAI,CAAC,EAAE;oBAC1DM,UAAU,EAAEtE,IAAI,CAACuE,QAAQ;oBACzBC,aAAa;sBAAA,IAAAC,cAAA,GAAAzF,iBAAA,eAAAzK,mBAAA,GAAA8G,IAAA,CAAE,SAAAqJ,SAAOlC,IAAI;wBAAA,OAAAjO,mBAAA,GAAAyB,IAAA,UAAA2O,UAAAC,SAAA;0BAAA,kBAAAA,SAAA,CAAA1I,IAAA,GAAA0I,SAAA,CAAAhL,IAAA;4BAAA;8BAAA,OAAAgL,SAAA,CAAAvL,MAAA,WAAKoH,WAAW,CAAC+B,IAAI,EAAEc,KAAI,CAACE,OAAO,CAACR,gBAAgB,CAAC;4BAAA;4BAAA;8BAAA,OAAA4B,SAAA,CAAAvI,IAAA;0BAAA;wBAAA,GAAAqI,QAAA;sBAAA;sBAAA,SAAAF,cAAAK,GAAA;wBAAA,OAAAJ,cAAA,CAAA9G,KAAA,OAAAG,SAAA;sBAAA;sBAAA,OAAA0G,aAAA;oBAAA;kBACjF,CAAC,CAAC;gBAAA;kBAHIP,WAAW,GAAAE,SAAA,CAAAjL,IAAA;kBAIjBoK,KAAI,CAAC5D,MAAM,CAACQ,QAAQ,CAACC,YAAY,CAAC,KAAK,CAAC;kBAAC,MAErC8D,WAAW,KAAK,MAAM;oBAAAE,SAAA,CAAAvK,IAAA;oBAAA;kBAAA;kBACxB0J,KAAI,CAAC5D,MAAM,CAACQ,QAAQ,CAACI,KAAK,CAAC,IAAI,EAAE;oBAAEC,cAAc,EAAE;kBAAM,CAAC,CAAC;kBAAC,OAAA4D,SAAA,CAAA9K,MAAA,WACrD,KAAK;gBAAA;kBAGd,IAAIkK,YAAY,CAACuB,QAAQ,CAAC,KAAK,CAAC,KAAKf,GAAG,EAAE;oBACxC;oBACAZ,KAAK,GAAG,IAAI;kBACd;kBAEAY,GAAG,GAAGR,YAAY,CAACuB,QAAQ,CAAC,KAAK,CAAC;kBAClCd,GAAG,GAAGT,YAAY,CAACuB,QAAQ,CAAC,KAAK,CAAC;kBAAC,OAAAX,SAAA,CAAA9K,MAAA,WAE5BiK,KAAI,CAAC5D,MAAM,CAACW,KAAK,EAAE,CAAC0E,QAAQ,CAAC;oBAAEhB,GAAG,EAAHA,GAAG;oBAAEC,GAAG,EAAHA,GAAG;oBAAEb,KAAK,EAALA;kBAAM,CAAC,CAAC,CAAC7C,KAAK,CAAC,IAAI,EAAE;oBAAEC,cAAc,EAAE;kBAAM,CAAC,CAAC,CAACC,GAAG,EAAE;gBAAA;kBAAA,OAAA2D,SAAA,CAAA9K,MAAA,WAGhG,IAAI;gBAAA;gBAAA;kBAAA,OAAA8K,SAAA,CAAA9H,IAAA;cAAA;YAAA,GAAAsH,QAAA;UAAA,CACZ;UAAA,iBAAAqB,GAAA;YAAA,OAAAtB,KAAA,CAAA/F,KAAA,OAAAG,SAAA;UAAA;QAAA;MAAA;IAAA;EAEL,CAAC;EAEDmH,WAAW,WAAAA,YAAA,EAAG;IACZ,OAAO1F,cAAc,CAAC,IAAI,CAAC;EAC7B,CAAC;EAED2F,SAAS,WAAAA,UAAA,EAAG;IACV,OAAO,CAAC;MAAEC,GAAG,EAAE;IAA+C,CAAC,CAAC;EAClE,CAAC;EAEDC,UAAU,WAAAA,WAAAC,KAAA,EAAqB;IAAA,IAAlBC,cAAc,GAAAD,KAAA,CAAdC,cAAc;IACzB,OAAO,CACL,KAAK,EACL;MAAE,OAAO,EAAE,sBAAsB;MAAE,YAAY,EAAE;IAAG,CAAC,EACrD,CACE,KAAK,EACLpG,eAAe,CAAC,IAAI,CAACsE,OAAO,CAAC8B,cAAc,EAAEA,cAAc,CAAC,CAC7D,CACF;EACH,CAAC;EAEDC,qBAAqB,WAAAA,sBAAA,EAAG;IACtB,IAAM7F,MAAM,GAAG,IAAI,CAACA,MAAM;IAC1B,IAAA8F,aAAA,GAA2C,IAAI,CAAChC,OAAO;MAA/CR,gBAAgB,GAAAwC,aAAA,CAAhBxC,gBAAgB;MAAEX,YAAY,GAAAmD,aAAA,CAAZnD,YAAY;IAEtC,IAAMoD,oBAAoB,GAAG,SAAvBA,oBAAoBA,CAAIC,cAAc,EAAK;MAC/CA,cAAc,CAAC/N,OAAO,CAAC,UAACgO,SAAS,EAAK;QACpC,IAAI,CAACA,SAAS,CAACC,GAAG,EAAE;UAClB;QACF;QAEAlG,MAAM,CAACQ,QAAQ,CAAC6E,QAAQ,CAAC;UAAEhB,GAAG,EAAE4B,SAAS,CAACC,GAAG;UAAE5B,GAAG,EAAE2B,SAAS,CAAC3D;QAAM,CAAC,CAAC;MACxE,CAAC,CAAC;IACJ,CAAC;IAED,OAAO,CACL,IAAI5C,MAAM,CAAC;MACTyG,KAAK,EAAE;QACLC,WAAW,WAAAA,YAACC,IAAI,EAAEC,KAAK,EAAE;UACvB,IAAMC,KAAK,GAAG,CAACD,KAAK,CAACE,aAAa,IAAIF,KAAK,CAACG,aAAa,CAACD,aAAa,EAAED,KAAK;UAC9E,IAAMG,MAAM,GAAGjE,YAAY,CAAC8D,KAAK,EAAE5D,YAAY,CAAC;UAChD,IAAI+D,MAAM,CAACvL,MAAM,GAAG,CAAC,EAAE;YACrB,OAAO,KAAK;UACd;UAEAa,OAAO,CAAC2K,GAAG,CAACD,MAAM,CAACE,GAAG,CAAC,UAACC,IAAI;YAAA,OAAK9F,WAAW,CAAC8F,IAAI,CAACC,SAAS,EAAE,EAAExD,gBAAgB,CAAC;UAAA,EAAC,CAAC,CAACzK,IAAI,CAAC,UAACmN,cAAc,EAAK;YAC1GD,oBAAoB,CAACC,cAAc,CAAC;UACtC,CAAC,CAAC;UAEF,OAAO,IAAI;QACb,CAAC;QAEDe,iBAAiB,WAAAA,kBAAA,EAAG;UAClB,IAAI,CAAC/G,MAAM,CAACgH,QAAQ,CAAC,OAAO,CAAC,EAAE;YAC7B,OAAO,KAAK;UACd;UAEAhH,MAAM,CAACW,KAAK,EAAE,CAACC,KAAK,EAAE,CAACmD,WAAW,EAAE,CAACjD,GAAG,EAAE;UAC1C,OAAO,IAAI;QACb,CAAC;QAEDmG,eAAe,EAAE;UACfC,IAAI,WAAAA,KAACb,IAAI,EAAEC,KAAK,EAAE;YAAA,IAAAa,mBAAA;YAChB,IAAMC,QAAQ,GAAGf,IAAI,CAACgB,WAAW,CAAC;cAACC,IAAI,EAAEhB,KAAK,CAACiB,OAAO;cAAEC,GAAG,EAAElB,KAAK,CAACmB;YAAO,CAAC,CAAC;YAE5E,IAAM/E,KAAK,GAAG4D,KAAK,aAALA,KAAK,wBAAAa,mBAAA,GAALb,KAAK,CAAEoB,YAAY,cAAAP,mBAAA,uBAAnBA,mBAAA,CAAqBzE,KAAK;YACxC,IAAI,CAACA,KAAK,IAAIA,KAAK,CAACvH,MAAM,GAAG,CAAC,EAAE;cAC9B;YACF;YAEA,IAAMuL,MAAM,GAAGjE,YAAY,CAACC,KAAK,EAAEC,YAAY,CAAC;YAChD,IAAI+D,MAAM,CAACvL,MAAM,GAAG,CAAC,EAAE;cACrB;YACF;YAEAmL,KAAK,CAACqB,cAAc,EAAE;;YAEtB;YACA;YACA;YACA;YACA3H,MAAM,CAACW,KAAK,EAAE,CAACC,KAAK,EAAE,CAACgH,gBAAgB,CAACR,QAAQ,CAACS,GAAG,CAAC,CAAC/G,GAAG,EAAE;YAE3D9E,OAAO,CAAC2K,GAAG,CAACD,MAAM,CAACE,GAAG,CAAC,UAAC1F,KAAK;cAAA,OAAKH,WAAW,CAACG,KAAK,EAAEoC,gBAAgB,CAAC;YAAA,EAAC,CAAC,CAACzK,IAAI,CAAC,UAACmN,cAAc,EAAK;cAChGD,oBAAoB,CAACC,cAAc,CAAC;YACtC,CAAC,CAAC;UACJ;QACF;MACF;IACF,CAAC,CAAC,CACH;EACH;AACF,CAAC,CAAC"},"metadata":{},"sourceType":"module","externalDependencies":[]}