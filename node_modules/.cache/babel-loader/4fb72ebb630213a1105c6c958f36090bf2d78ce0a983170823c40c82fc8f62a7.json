{"ast":null,"code":"$(function () {\n  $(\".check-custom-redirections\").on(\"click\", function (evt) {\n    evt.preventDefault();\n    if ($(evt.target).hasClass(\"disabled\")) {\n      return;\n    }\n    $(evt.target).addClass(\"disabled\");\n    var getReport = function getReport(tr, response) {\n      var item = $(tr).data(\"item\");\n      var $td = $(tr).find(\".redirect-status\");\n      var type = response.type;\n      var status = response.status;\n      if (response.type === \"opaqueredirect\") {\n        type = \"redirect\";\n        status = \"302\";\n      }\n      if (item.active) {\n        if (type === \"redirect\") {\n          $td.addClass(\"success\");\n        } else {\n          $td.addClass(\"alert\");\n        }\n      } else {\n        $td.addClass(\"muted\");\n      }\n      return \"\".concat(type, \" (\").concat(status, \")\");\n    };\n    $(\"tr.custom-redirection\").each(function (index, tr) {\n      var $td = $(tr).find(\".redirect-status\");\n      $td.html('<span class=\"loading-spinner\" />');\n      fetch($(tr).data(\"origin\"), {\n        method: \"HEAD\",\n        redirect: \"manual\"\n      }).then(function (response) {\n        $td.html(getReport(tr, response));\n      })[\"catch\"](function (error) {\n        console.error(\"ERROR\", error);\n        $td.removeClass(\"loading\");\n      });\n    });\n  });\n});","map":{"version":3,"names":["$","on","evt","preventDefault","target","hasClass","addClass","getReport","tr","response","item","data","$td","find","type","status","active","concat","each","index","html","fetch","method","redirect","then","error","console","removeClass"],"sources":["/home/daniele/.rbenv/versions/3.0.2/lib/ruby/gems/3.0.0/gems/decidim-decidim_awesome-0.10.2/app/packs/src/decidim/decidim_awesome/admin/check_redirections.js"],"sourcesContent":["$(() => {\n  $(\".check-custom-redirections\").on(\"click\", (evt) => {\n    evt.preventDefault();\n    \n    if ($(evt.target).hasClass(\"disabled\")) {\n      return;\n    }\n    \n    $(evt.target).addClass(\"disabled\");\n\n    const getReport = (tr, response) => {\n      const item = $(tr).data(\"item\");\n      const $td = $(tr).find(\".redirect-status\");\n\n      let type = response.type;\n      let status = response.status;\n      if (response.type === \"opaqueredirect\") {\n        type = \"redirect\";\n        status = \"302\";\n      }\n\n      if (item.active) {\n        if (type ===  \"redirect\") {\n          $td.addClass(\"success\");\n        } else {\n          $td.addClass(\"alert\");\n        }\n      } else {\n        $td.addClass(\"muted\");\n      }\n\n      return `${type} (${status})`;\n    };\n\n    $(\"tr.custom-redirection\").each((index, tr) => {\n      const $td = $(tr).find(\".redirect-status\");\n      $td.html('<span class=\"loading-spinner\" />');\n      fetch($(tr).data(\"origin\"), {method: \"HEAD\", redirect: \"manual\"}).\n        then((response) => {\n          $td.html(getReport(tr, response))\n        }).\n        catch((error) => {\n          console.error(\"ERROR\", error)  \n          $td.removeClass(\"loading\");\n        });\n    });\n  });\n});\n"],"mappings":"AAAAA,CAAC,CAAC,YAAM;EACNA,CAAC,CAAC,4BAA4B,CAAC,CAACC,EAAE,CAAC,OAAO,EAAE,UAACC,GAAG,EAAK;IACnDA,GAAG,CAACC,cAAc,CAAC,CAAC;IAEpB,IAAIH,CAAC,CAACE,GAAG,CAACE,MAAM,CAAC,CAACC,QAAQ,CAAC,UAAU,CAAC,EAAE;MACtC;IACF;IAEAL,CAAC,CAACE,GAAG,CAACE,MAAM,CAAC,CAACE,QAAQ,CAAC,UAAU,CAAC;IAElC,IAAMC,SAAS,GAAG,SAAZA,SAASA,CAAIC,EAAE,EAAEC,QAAQ,EAAK;MAClC,IAAMC,IAAI,GAAGV,CAAC,CAACQ,EAAE,CAAC,CAACG,IAAI,CAAC,MAAM,CAAC;MAC/B,IAAMC,GAAG,GAAGZ,CAAC,CAACQ,EAAE,CAAC,CAACK,IAAI,CAAC,kBAAkB,CAAC;MAE1C,IAAIC,IAAI,GAAGL,QAAQ,CAACK,IAAI;MACxB,IAAIC,MAAM,GAAGN,QAAQ,CAACM,MAAM;MAC5B,IAAIN,QAAQ,CAACK,IAAI,KAAK,gBAAgB,EAAE;QACtCA,IAAI,GAAG,UAAU;QACjBC,MAAM,GAAG,KAAK;MAChB;MAEA,IAAIL,IAAI,CAACM,MAAM,EAAE;QACf,IAAIF,IAAI,KAAM,UAAU,EAAE;UACxBF,GAAG,CAACN,QAAQ,CAAC,SAAS,CAAC;QACzB,CAAC,MAAM;UACLM,GAAG,CAACN,QAAQ,CAAC,OAAO,CAAC;QACvB;MACF,CAAC,MAAM;QACLM,GAAG,CAACN,QAAQ,CAAC,OAAO,CAAC;MACvB;MAEA,UAAAW,MAAA,CAAUH,IAAI,QAAAG,MAAA,CAAKF,MAAM;IAC3B,CAAC;IAEDf,CAAC,CAAC,uBAAuB,CAAC,CAACkB,IAAI,CAAC,UAACC,KAAK,EAAEX,EAAE,EAAK;MAC7C,IAAMI,GAAG,GAAGZ,CAAC,CAACQ,EAAE,CAAC,CAACK,IAAI,CAAC,kBAAkB,CAAC;MAC1CD,GAAG,CAACQ,IAAI,CAAC,kCAAkC,CAAC;MAC5CC,KAAK,CAACrB,CAAC,CAACQ,EAAE,CAAC,CAACG,IAAI,CAAC,QAAQ,CAAC,EAAE;QAACW,MAAM,EAAE,MAAM;QAAEC,QAAQ,EAAE;MAAQ,CAAC,CAAC,CAC/DC,IAAI,CAAC,UAACf,QAAQ,EAAK;QACjBG,GAAG,CAACQ,IAAI,CAACb,SAAS,CAACC,EAAE,EAAEC,QAAQ,CAAC,CAAC;MACnC,CAAC,CAAC,SACG,CAAC,UAACgB,KAAK,EAAK;QACfC,OAAO,CAACD,KAAK,CAAC,OAAO,EAAEA,KAAK,CAAC;QAC7Bb,GAAG,CAACe,WAAW,CAAC,SAAS,CAAC;MAC5B,CAAC,CAAC;IACN,CAAC,CAAC;EACJ,CAAC,CAAC;AACJ,CAAC,CAAC","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}