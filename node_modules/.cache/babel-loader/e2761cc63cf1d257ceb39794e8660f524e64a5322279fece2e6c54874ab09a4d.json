{"ast":null,"code":"$(function () {\n  var $modal = $(\"#constraintsModal\");\n  if (!$modal.length) {\n    return;\n  }\n  $(\".decidim_awesome-form\").on(\"click\", \".constraints-editor .add-condition,.constraints-editor .edit-condition\", function (evt) {\n    evt.preventDefault();\n    var $this = $(evt.target);\n    var url = $this.attr(\"href\");\n    var $callout = $this.closest(\".constraints-editor\").find(\".callout\");\n    $callout.hide();\n    $callout.removeClass(\"alert success\");\n    $modal.find(\".modal-content\").html(\"\");\n    $modal.addClass(\"loading\");\n    $modal.data(\"url\", url);\n    $modal.foundation(\"open\");\n    $modal.find(\".modal-content\").load(url, function () {\n      $modal.removeClass(\"loading\");\n    });\n  });\n\n  // Custom event listener to reload the modal if needed\n  document.body.addEventListener(\"constraint:change\", function (evt) {\n    var vars = evt.detail.map(function (setting) {\n      return \"\".concat(setting.key, \"=\").concat(setting.value);\n    });\n    var url = \"\".concat($modal.data(\"url\"), \"&\").concat(vars.join(\"&\"));\n    // console.log(\"constraint:change vars:\", vars, \"url:\", url)\n    $modal.addClass(\"loading\");\n    $modal.find(\".modal-content\").load(url, function () {\n      $modal.removeClass(\"loading\");\n    });\n  });\n\n  // Rails AJAX events\n  document.body.addEventListener(\"ajax:error\", function (responseText) {\n    // console.log(\"ajax:error\", responseText)\n    var $container = $(\".constraints-editor[data-key=\\\"\".concat(responseText.detail[0].key, \"\\\"]\"));\n    var $callout = $container.find(\".callout\");\n    $callout.show();\n    $callout.contents(\"p\").html(\"\".concat(responseText.detail[0].message, \": <strong>\").concat(responseText.detail[0].error, \"</strong>\"));\n    $callout.addClass(\"alert\");\n  });\n  document.body.addEventListener(\"ajax:success\", function (responseText) {\n    // console.log(\"ajax:success\", responseText)\n    var $container = $(\".constraints-editor[data-key=\\\"\".concat(responseText.detail[0].key, \"\\\"]\"));\n    var $callout = $container.find(\".callout\");\n    $modal.foundation(\"close\");\n    $callout.show();\n    $callout.contents(\"p\").html(responseText.detail[0].message);\n    $callout.addClass(\"success\");\n    // reconstruct list\n    $container.replaceWith(responseText.detail[0].html);\n  });\n});","map":{"version":3,"names":["$","$modal","length","on","evt","preventDefault","$this","target","url","attr","$callout","closest","find","hide","removeClass","html","addClass","data","foundation","load","document","body","addEventListener","vars","detail","map","setting","concat","key","value","join","responseText","$container","show","contents","message","error","replaceWith"],"sources":["/home/daniele/.rbenv/versions/3.0.2/lib/ruby/gems/3.0.0/gems/decidim-decidim_awesome-0.10.2/app/packs/src/decidim/decidim_awesome/admin/constraints.js"],"sourcesContent":["$(() => {\n  const $modal = $(\"#constraintsModal\");\n  if (!$modal.length) {\n    return;\n  }\n\n  $(\".decidim_awesome-form\").on(\"click\", \".constraints-editor .add-condition,.constraints-editor .edit-condition\", (evt) => {\n    evt.preventDefault();\n    const $this = $(evt.target)\n    const url = $this.attr(\"href\");\n    const $callout = $this.closest(\".constraints-editor\").find(\".callout\");\n    $callout.hide();\n    $callout.removeClass(\"alert success\");\n    $modal.find(\".modal-content\").html(\"\");\n    $modal.addClass(\"loading\");\n    $modal.data(\"url\", url);\n    $modal.foundation(\"open\");\n    $modal.find(\".modal-content\").load(url, () => {\n      $modal.removeClass(\"loading\");\n    });\n  });\n\n  // Custom event listener to reload the modal if needed\n  document.body.addEventListener(\"constraint:change\", (evt) => {\n    const vars = evt.detail.map((setting) => `${setting.key}=${setting.value}`);\n    const url = `${$modal.data(\"url\")}&${vars.join(\"&\")}`;\n    // console.log(\"constraint:change vars:\", vars, \"url:\", url)\n    $modal.addClass(\"loading\");\n    $modal.find(\".modal-content\").load(url, () => {\n      $modal.removeClass(\"loading\");\n    });\n  });\n\n  // Rails AJAX events\n  document.body.addEventListener(\"ajax:error\", (responseText) => {\n    // console.log(\"ajax:error\", responseText)\n    const $container = $(`.constraints-editor[data-key=\"${responseText.detail[0].key}\"]`)\n    const $callout = $container.find(\".callout\");\n    $callout.show();\n    $callout.contents(\"p\").html(`${responseText.detail[0].message}: <strong>${responseText.detail[0].error}</strong>`);\n    $callout.addClass(\"alert\");\n  });\n\n  document.body.addEventListener(\"ajax:success\", (responseText) => {\n    // console.log(\"ajax:success\", responseText)\n    const $container = $(`.constraints-editor[data-key=\"${responseText.detail[0].key}\"]`)\n    const $callout = $container.find(\".callout\");\n    $modal.foundation(\"close\");\n    $callout.show();\n    $callout.contents(\"p\").html(responseText.detail[0].message);\n    $callout.addClass(\"success\");\n    // reconstruct list\n    $container.replaceWith(responseText.detail[0].html);\n  });\n});\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}