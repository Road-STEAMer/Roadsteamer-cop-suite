{"ast":null,"code":"function _typeof(o) {\n  \"@babel/helpers - typeof\";\n\n  return _typeof = \"function\" == typeof Symbol && \"symbol\" == typeof Symbol.iterator ? function (o) {\n    return typeof o;\n  } : function (o) {\n    return o && \"function\" == typeof Symbol && o.constructor === Symbol && o !== Symbol.prototype ? \"symbol\" : typeof o;\n  }, _typeof(o);\n}\nfunction _classCallCheck(a, n) {\n  if (!(a instanceof n)) throw new TypeError(\"Cannot call a class as a function\");\n}\nfunction _defineProperties(e, r) {\n  for (var t = 0; t < r.length; t++) {\n    var o = r[t];\n    o.enumerable = o.enumerable || !1, o.configurable = !0, \"value\" in o && (o.writable = !0), Object.defineProperty(e, _toPropertyKey(o.key), o);\n  }\n}\nfunction _createClass(e, r, t) {\n  return r && _defineProperties(e.prototype, r), t && _defineProperties(e, t), Object.defineProperty(e, \"prototype\", {\n    writable: !1\n  }), e;\n}\nfunction _toPropertyKey(t) {\n  var i = _toPrimitive(t, \"string\");\n  return \"symbol\" == _typeof(i) ? i : i + \"\";\n}\nfunction _toPrimitive(t, r) {\n  if (\"object\" != _typeof(t) || !t) return t;\n  var e = t[Symbol.toPrimitive];\n  if (void 0 !== e) {\n    var i = e.call(t, r || \"default\");\n    if (\"object\" != _typeof(i)) return i;\n    throw new TypeError(\"@@toPrimitive must return a primitive value.\");\n  }\n  return (\"string\" === r ? String : Number)(t);\n}\nvar DEFAULT_MESSAGES = {\n  correctErrors: \"There are errors on the form, please correct them.\"\n};\nvar MESSAGES = DEFAULT_MESSAGES;\nvar FormValidator = /*#__PURE__*/function () {\n  function FormValidator(form) {\n    var _this = this;\n    _classCallCheck(this, FormValidator);\n    this.$form = form;\n    this.$form.on(\"form-error.decidim\", function () {\n      _this.handleError();\n    });\n  }\n  return _createClass(FormValidator, [{\n    key: \"handleError\",\n    value: function handleError() {\n      this.announceFormError();\n      $(\".is-invalid-input:first\", this.$form).focus();\n    }\n\n    /**\n     * This announces immediately to the screen reader that there are errors on\n     * the form that need to be fixed. Does not work on all screen readers but\n     * works e.g. in Windows+Firefox+NVDA and macOS+Safari+VoiceOver\n     * combinations.\n     *\n     * @returns {undefined}\n     */\n  }, {\n    key: \"announceFormError\",\n    value: function announceFormError() {\n      var $announce = $(\".sr-announce\", this.$form);\n      if ($announce.length > 0) {\n        $announce.remove();\n      }\n      $announce = $(\"<div />\");\n      $announce.attr(\"class\", \"sr-announce show-for-sr\");\n      $announce.attr(\"aria-live\", \"assertive\");\n      this.$form.prepend($announce);\n      setTimeout(function () {\n        $announce.text(MESSAGES.correctErrors);\n      }, 100);\n    }\n  }], [{\n    key: \"configureMessages\",\n    value: function configureMessages(messages) {\n      MESSAGES = $.extend(DEFAULT_MESSAGES, messages);\n    }\n  }]);\n}();\nexport { FormValidator as default };\n$(function () {\n  $(\"form\").each(function (_i, el) {\n    $(el).data(\"form-validator\", new FormValidator($(el)));\n  });\n  $(document).on(\"forminvalid.zf.abide\", function (_ev, form) {\n    form.trigger(\"form-error.decidim\");\n  });\n});","map":{"version":3,"names":["DEFAULT_MESSAGES","correctErrors","MESSAGES","FormValidator","form","_this","_classCallCheck","$form","on","handleError","_createClass","key","value","announceFormError","$","focus","$announce","length","remove","attr","prepend","setTimeout","text","configureMessages","messages","extend","default","each","_i","el","data","document","_ev","trigger"],"sources":["/home/daniele/decidim_idra/app/packs/src/decidim/form_validator.js"],"sourcesContent":["const DEFAULT_MESSAGES = {\n  correctErrors: \"There are errors on the form, please correct them.\"\n};\nlet MESSAGES = DEFAULT_MESSAGES;\n\nexport default class FormValidator {\n  static configureMessages(messages) {\n    MESSAGES = $.extend(DEFAULT_MESSAGES, messages);\n  }\n\n  constructor(form) {\n    this.$form = form;\n\n    this.$form.on(\"form-error.decidim\", () => {\n      this.handleError();\n    });\n  }\n\n  handleError() {\n    this.announceFormError();\n\n    $(\".is-invalid-input:first\", this.$form).focus();\n  }\n\n  /**\n   * This announces immediately to the screen reader that there are errors on\n   * the form that need to be fixed. Does not work on all screen readers but\n   * works e.g. in Windows+Firefox+NVDA and macOS+Safari+VoiceOver\n   * combinations.\n   *\n   * @returns {undefined}\n   */\n  announceFormError() {\n    let $announce = $(\".sr-announce\", this.$form);\n    if ($announce.length > 0) {\n      $announce.remove();\n    }\n    $announce = $(\"<div />\");\n    $announce.attr(\"class\", \"sr-announce show-for-sr\");\n    $announce.attr(\"aria-live\", \"assertive\");\n    this.$form.prepend($announce);\n\n    setTimeout(() => {\n      $announce.text(MESSAGES.correctErrors);\n    }, 100);\n  }\n}\n\n$(() => {\n  $(\"form\").each((_i, el) => {\n    $(el).data(\"form-validator\", new FormValidator($(el)));\n  });\n  $(document).on(\"forminvalid.zf.abide\", function(_ev, form) {\n    form.trigger(\"form-error.decidim\");\n  })\n});\n"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAAA,IAAMA,gBAAgB,GAAG;EACvBC,aAAa,EAAE;AACjB,CAAC;AACD,IAAIC,QAAQ,GAAGF,gBAAgB;AAAC,IAEXG,aAAa;EAKhC,SAAAA,cAAYC,IAAI,EAAE;IAAA,IAAAC,KAAA;IAAAC,eAAA,OAAAH,aAAA;IAChB,IAAI,CAACI,KAAK,GAAGH,IAAI;IAEjB,IAAI,CAACG,KAAK,CAACC,EAAE,CAAC,oBAAoB,EAAE,YAAM;MACxCH,KAAI,CAACI,WAAW,CAAC,CAAC;IACpB,CAAC,CAAC;EACJ;EAAC,OAAAC,YAAA,CAAAP,aAAA;IAAAQ,GAAA;IAAAC,KAAA,EAED,SAAAH,YAAA,EAAc;MACZ,IAAI,CAACI,iBAAiB,CAAC,CAAC;MAExBC,CAAC,CAAC,yBAAyB,EAAE,IAAI,CAACP,KAAK,CAAC,CAACQ,KAAK,CAAC,CAAC;IAClD;;IAEA;AACF;AACA;AACA;AACA;AACA;AACA;AACA;EAPE;IAAAJ,GAAA;IAAAC,KAAA,EAQA,SAAAC,kBAAA,EAAoB;MAClB,IAAIG,SAAS,GAAGF,CAAC,CAAC,cAAc,EAAE,IAAI,CAACP,KAAK,CAAC;MAC7C,IAAIS,SAAS,CAACC,MAAM,GAAG,CAAC,EAAE;QACxBD,SAAS,CAACE,MAAM,CAAC,CAAC;MACpB;MACAF,SAAS,GAAGF,CAAC,CAAC,SAAS,CAAC;MACxBE,SAAS,CAACG,IAAI,CAAC,OAAO,EAAE,yBAAyB,CAAC;MAClDH,SAAS,CAACG,IAAI,CAAC,WAAW,EAAE,WAAW,CAAC;MACxC,IAAI,CAACZ,KAAK,CAACa,OAAO,CAACJ,SAAS,CAAC;MAE7BK,UAAU,CAAC,YAAM;QACfL,SAAS,CAACM,IAAI,CAACpB,QAAQ,CAACD,aAAa,CAAC;MACxC,CAAC,EAAE,GAAG,CAAC;IACT;EAAC;IAAAU,GAAA;IAAAC,KAAA,EAvCD,SAAAW,kBAAyBC,QAAQ,EAAE;MACjCtB,QAAQ,GAAGY,CAAC,CAACW,MAAM,CAACzB,gBAAgB,EAAEwB,QAAQ,CAAC;IACjD;EAAC;AAAA;AAAA,SAHkBrB,aAAa,IAAAuB,OAAA;AA2ClCZ,CAAC,CAAC,YAAM;EACNA,CAAC,CAAC,MAAM,CAAC,CAACa,IAAI,CAAC,UAACC,EAAE,EAAEC,EAAE,EAAK;IACzBf,CAAC,CAACe,EAAE,CAAC,CAACC,IAAI,CAAC,gBAAgB,EAAE,IAAI3B,aAAa,CAACW,CAAC,CAACe,EAAE,CAAC,CAAC,CAAC;EACxD,CAAC,CAAC;EACFf,CAAC,CAACiB,QAAQ,CAAC,CAACvB,EAAE,CAAC,sBAAsB,EAAE,UAASwB,GAAG,EAAE5B,IAAI,EAAE;IACzDA,IAAI,CAAC6B,OAAO,CAAC,oBAAoB,CAAC;EACpC,CAAC,CAAC;AACJ,CAAC,CAAC","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}